!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Avalon requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(b,c){function i(){b.console&&avalon.config.debug&&Function.apply.call(console.log,console,arguments)}function z(a){return Function.apply(A,a)}function A(){}function B(a,b){var c,d,e,f;for("string"==typeof a&&(a=a.match(l)||[]),c={},d=void 0!==b?b:1,e=0,f=a.length;f>e;e++)c[a[e]]=d;return c}function D(){if(b.VBArray){var a=document.documentMode;return a?a:b.XMLHttpRequest?7:6}return 0/0}function G(a){return o.test(r.call(a))}function J(a,b){return a=Math.floor(a)||0,0>a?Math.max(b+a,0):Math.min(a,b)}function N(a){var b,c;if(!a)return!1;if(b=a.length,b===b>>>0){if(c=r.call(a).slice(8,-1),/(?:regexp|string|function|window|global)$/i.test(c))return!1;if("Array"===c)return!0;try{return{}.propertyIsEnumerable.call(a,"length")===!1?/^\s?function/.test(a.item||a.callee):!0}catch(d){return!a.window}}return!1}function U(a,b,c){var d="for(var "+a+"i=0,n = this.length; i < n; i++){"+b.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+c;return Function("fn,scope",d)}function V(a,b){try{for(;b=b.parentNode;)if(b===a)return!0;return!1}catch(c){return!1}}function W(){return(new XMLSerializer).serializeToString(this)}function Z(a,b){var c,f,d,g;if(a&&a.childNodes)for(c=a.childNodes,d=0;f=c[d++];)f.tagName&&(g=e.createElementNS(X,f.tagName.toLowerCase()),s.forEach.call(f.attributes,function(a){g.setAttribute(a.name,a.value)}),Z(f,g),b.appendChild(g))}function _(a){var c,d,f,g,b={};for(c in a)b[c]=a[c];return d=b.target=a.srcElement,0===a.type.indexOf("key")?b.which=null!=a.charCode?a.charCode:a.keyCode:$.test(a.type)&&(f=d.ownerDocument||e,g="BackCompat"===f.compatMode?f.body:f.documentElement,b.pageX=a.clientX+(g.scrollLeft>>0)-(g.clientLeft>>0),b.pageY=a.clientY+(g.scrollTop>>0)-(g.clientTop>>0),b.wheelDeltaY=b.wheelDelta,b.wheelDeltaX=0),b.timeStamp=new Date-0,b.originalEvent=a,b.preventDefault=function(){a.returnValue=!1},b.stopPropagation=function(){a.cancelBubble=!0},b}function db(a){var b,c;for(b in a)q.call(a,b)&&(c=a[b],"function"==typeof db.plugins[b]?db.plugins[b](c):"object"==typeof db[b]?avalon.mix(db[b],c):db[b]=c);return this}function kb(a){return(a+"").replace(jb,"\\$&")}function mb(a,b){var f,g,c=this.$events||(this.$events={}),d=c[a]||(c[a]=[]);return"function"==typeof b&&(f=b,f.uniqueNumber=Math.random(),b={element:v,type:"user-watcher",handler:A,vmodels:[this],expr:a,uniqueNumber:f.uniqueNumber},b.wildcard=/\*/.test(a)),b.update?b.oneTime||avalon.Array.ensure(d,b):(/\w\.*\B/.test(a)?(b.getter=A,g=this,b.update=function(){var a=this.fireArgs||[];a[2]&&b.handler.apply(g,a),delete this.fireArgs},d.sync=!0,avalon.Array.ensure(d,b)):avalon.injectBinding(b),f&&(b.handler=f)),function(){b.update=b.getter=b.handler=A,b.element=e.createElement("a")}}function nb(a,b){var d,e,f,g,h,c=this.$events;if(c&&c[a])b&&(b[2]=a),d=c[a],pb(d,b),e=this.$up,e&&(this.$pathname&&nb.call(e,this.$pathname+"."+a,b),nb.call(e,"*."+a,b));else{if(e=this.$up,this.$ups){for(f in this.$ups)nb.call(this.$ups[f],f+"."+a,b);return}e&&(g=this.$pathname,""===g&&(g="*"),h=g+"."+a,d=h.split("."),-1===d.indexOf("*")?(nb.call(e,h,b),d[1]="*",nb.call(e,d.join("."),b)):nb.call(e,h,b))}}function ob(a,b){for(var c,d;;){if(a.$watch)return c=a.$events||(a.$events={}),d=c[b]||(c[b]=[]),Qb.collectDependency(d),void 0;if(a=a.$up,!a)break;b=a.$pathname+"."+b}}function pb(a,b){var c,d,f,e,g;if(a){for(new Date-Xb>444&&"object"==typeof a[0]&&_b(),c=[],d=[],e=0;f=a[e++];)"user-watcher"===f.type?c.push(f):d.push(f);if(db.async)for(Od.render(),e=0;f=d[e++];)f.update&&(g=Zb(f),Od.queue[g]||(Od.queue[g]=1,Od.queue.push(f)));else for(e=0;f=d[e++];)f.update&&f.update();for(e=0;f=c[e++];)(b&&b[2]===f.expr||f.wildcard)&&(f.fireArgs=b),f.update()}}function wb(a,b){return b=b||{},b.watch=!0,yb(a,b)}function xb(){}function yb(a,b){function q(a){return h[a]===!0}var c,d,e,f,g,h,j,l,m,n,o,p;if(!a||a.$id&&a.$accessors||a.nodeName&&a.nodeType>0)return a;if(b=b||k,c=b.force||k,d=b.old,e=d&&d.$accessors||k,f=new xb,g={},h={},j=[],l=[],m={},a.$skipArray&&(m=B(a.$skipArray),delete a.$skipArray),n=a.$computed){delete a.$computed;for(o in n)h[o]=!0,function(a,b){var c;g[a]={get:function(){return c=b.get.call(this)},set:function(d){var e,f;"function"==typeof b.set&&(e=c,b.set.call(this,d),f=this[a],this.$fire&&f!==e&&this.$fire(a,f,e))},enumerable:!0,configurable:!0}}(o,n[o])}for(o in a)p=a[o],rb[o]||(h[o]=!0),"function"==typeof p||p&&p.nodeName&&p.nodeType>0||!c[o]&&("$"===o.charAt(0)||rb[o]||m[o])?j.push(o):zb(p)?(i("warning:计算属性建议放在$computed对象中统一定义"),function(a,b){var c;g[a]={get:function(){return c=b.get.call(this)},set:function(d){var e,f;"function"==typeof b.set&&(e=c,b.set.call(this,d),f=this[a],this.$fire&&f!==e&&this.$fire(a,f,e))},enumerable:!0,configurable:!0}}(o,p)):(l.push(o),g[o]=e[o]?e[o]:Ab(o,p));g["$model"]=Gb,f=ub(f,g,a),j.forEach(function(b){f[b]=a[b]}),Eb(f,"$ups",null),Eb(f,"$id","anonymous"),Eb(f,"$up",d?d.$up:null),Eb(f,"$track",Object.keys(h)),Eb(f,"$active",!1),Eb(f,"$pathname",d?d.$pathname:""),Eb(f,"$accessors",g),Eb(f,"hasOwnProperty",q),b.watch&&(Eb(f,"$watch",function(){return mb.apply(f,arguments)}),Eb(f,"$fire",function(a,b){var c,d,e;if(0===a.indexOf("all!")){c=a.slice(4);for(d in avalon.vmodels)e=avalon.vmodels[d],e.$fire&&e.$fire.apply(e,[c,b])}else nb.call(f,a,[b])})),l.forEach(function(b){var c=d&&d[b],e=f[b]=a[b];e&&"object"==typeof e&&(e.$up=f,e.$pathname=b),nb.call(f,b,[e,c])});for(o in n)p=f[o];return f.$active=!0,f}function zb(a){if(a&&"object"==typeof a){for(var b in a)if("get"!==b&&"set"!==b)return!1;return"function"==typeof a.get}}function Ab(a,b){var c;return b=0/0,{get:function(){return this.$active&&ob(this,a),b},set:function(d){if(b!==d){var e=b;c=Bb(d,b),c?b=c:(c=void 0,b=d),Object(c)===c&&(c.$pathname=a,c.$up=this),this.$active&&nb.call(this,a,[b,e])}},enumerable:!0,configurable:!0}}function Bb(a,b,c,d){var e,f,g;if(Array.isArray(a))return Db(a,b,d);if(avalon.isPlainObject(a)){if(b&&"object"==typeof b){if(e=Cb(a),f=Cb(b),e.join(";")===f.join(";")){for(g in a)a.hasOwnProperty(g)&&(b[g]=a[g]);return b}b.$active=!1}return yb(a,{old:b,watch:d})}return c?a:void 0}function Db(a,b,c){var d,e,f,g,h;if(b)return d=[0,b.length].concat(a),b.splice.apply(b,d),b;for(e in Lb)a[e]=Lb[e];for(Eb(a,"$up",null),Eb(a,"$pathname",""),Eb(a,"$track",Ob(a.length)),a._=yb({length:0/0},{watch:!0}),a._.length=a.length,a._.$watch("length",function(b,c){nb.call(a.$up,a.$pathname+".length",[b,c])}),c&&Eb(a,"$watch",function(){return mb.apply(a,arguments)}),u?Object.defineProperty(a,"$model",Gb):a.$model=Fb(a),f=0,g=a.length;g>f;f++)h=a[f]=Bb(a[f],0,1,1),Object(h)===h&&(h.$up=a);return a}function Eb(a,b,c){tb?Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!1,configurable:!0}):a[b]=c}function Fb(a){var c,d,e,f,b=avalon.type(a);if("array"===b){for(c=[],d=0;d<a.length;d++)c[d]=Fb(a[d]);return c}if("object"===b){e={};for(d in a)"__proxy__"!==d&&"__data__"!==d&&"__const__"!==d&&a.hasOwnProperty(d)&&(f=a[d],e[d]=f&&f.nodeType?f:Fb(f));return e}return a}function Ib(a,b,c,d){var e=b[c];return 4!==arguments.length?e.get.call(a):(e.set.call(a,d),void 0)}function Nb(a,b){var d,e,f,c={};for(d=0,e=b.length;e>d;d++)c[d]=a[d],f=b[d],f in c?(a[d]=c[f],delete c[f]):a[d]=a[f]}function Ob(a){var c,b=[];for(c=0;a>c;c++)b[c]=C("$proxy$each");return b}function Pb(a,b,c){switch(b){case"push":case"unshift":c=Ob(c.length);break;case"splice":c.length>2&&(c[1],c.length-2,c=[c[0],c[1]].concat(Ob(c.length-2)))}Array.prototype[b].apply(a,c)}function Tb(a,b){b.oneTime||a&&avalon.Array.ensure(a,b)&&b.element&&($b(b,a),new Date-Xb>444&&_b())}function Ub(a,b){var e,d,c=[];for(d=0;e=a[d++];)c.push(b?e.$id:e.$key);return c.join(";")}function Zb(a){if(!a.uniqueNumber){var b=a.element;a.uniqueNumber=b?1!==b.nodeType?a.type+"-"+Zb(b.parentNode)+"-"+ ++Vb:a.name+"-"+Zb(b):++Vb}return a.uniqueNumber}function $b(a,b){var c=a.lists||(a.lists=[]),d=Zb(a);avalon.Array.ensure(c,b),b.$uuid=b.$uuid||C(),Wb[d]||(Wb[d]=1,Wb.push(a))}function _b(a){for(var g,h,i,k,j,b=Wb.length,c=b,d=[],e={},f={};a=Wb[--b];)g=a.type,f[g]?f[g]++:(f[g]=1,d.push(g));if(h=!1,d.forEach(function(a){Yb[a]!==f[a]&&(e[a]=1,h=!0)}),b=c,h)for(;a=Wb[--b];)if(null!==a.element){if(e[a.type]&&bc(a.element)){for(Wb.splice(b,1),delete Wb[a.uniqueNumber],i=a.lists,j=0;k=i[j++];)avalon.Array.remove(i,k),avalon.Array.remove(k,a);ac(a)}}else Wb.splice(b,1);Yb=f,Xb=new Date}function ac(a){delete Wb[a.uniqueNumber],a.element=null,a.rollback&&a.rollback();for(var b in a)a[b]=null}function bc(a){try{a.parentNode.nodeType}catch(c){return!0}return a.ifRemove&&!v.contains(a.ifRemove)&&g===a.parentNode?(a.parentNode&&a.parentNode.removeChild(a),!0):a.msRetain?0:1===a.nodeType?!v.contains(a):!avalon.contains(v,a)}function kc(a){var b=a.nodeName;return b.toLowerCase()===b&&a.scopeName&&""===a.outerText}function lc(a){"url(#default#VML)"!==a.currentStyle.behavior&&(a.style.behavior="url(#default#VML)",a.style.display="inline-block",a.style.zoom=1)}function mc(a){return a.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function nc(a){return!a||a.indexOf("-")<0&&a.indexOf("_")<0?a:a.replace(/[-_][^-_]/g,function(a){return a.charAt(1).toUpperCase()})}function pc(a){if(!("classList"in a)){a.classList={node:a};for(var b in oc)a.classList[b.slice(1)]=oc[b]}return a.classList}function qc(a){try{if("object"==typeof a)return a;a="true"===a?!0:"false"===a?!1:"null"===a?null:+a+""===a?+a:rc.test(a)?avalon.parseJSON(a):a}catch(b){}return a}function wc(a){return a.window&&a.document?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}function Ic(a,b){var c,d,e;if(a.offsetWidth<=0){if(Hc.test(xc["@:get"](a,"display"))){c={node:a};for(d in Gc)c[d]=a.style[d],a.style[d]=Gc[d];b.push(c)}e=a.parentNode,e&&1===e.nodeType&&Ic(e,b)}}function Jc(a){var b=a.tagName.toLowerCase();return"input"===b&&/checkbox|radio/.test(a.type)?"checked":b}function Qc(a,b){var e,f,g,h,i,j,k,l,m,c=[],d=!!b;for(b=b||0,e="unknown",f="",g=0;g<a.length;g++)if(h=a.charAt(g),"'"===h||'"'===h)"unknown"===e?e=h:e===h&&(e="unknown");else if("\\"===h)("'"===e||'"'===e)&&g++;else if(Oc.test(h))"unknown"===e?(e="variable",f=h):"maybePath"===e?(f=c.pop(),f+="."+h,e="variable"):"variable"===e&&(f+=h);else if(/\w/.test(h))"variable"===e&&(f+=h);else if("."===h)"variable"===e&&f&&(c.push(f),f="",e="maybePath");else if("["===h){if("variable"===e||"maybePath"===e){if(f&&(c.push(f),f=""),i=c.length,j=c[i-1],k=Qc(a.slice(g),g),k.length)c[i-1]=j+".*",c=k.concat(c);else{l=a.slice(g+1,k.i);try{m=z(["return "+l])(),c[i-1]=j+"."+m}catch(n){}}e="maybePath",g=k.i}}else if("]"===h){if(d)return c.i=g+b,Rc(c,f),c}else Pc.test(h)&&"\r"!==h&&"\n"!==h?"variable"===e&&(Rc(c,f)&&(e="maybePath"),f=""):(Rc(c,f),e="unknown",f="");return Rc(c,f),c}function Rc(a,b){return b&&!Mc[b]?(a.push(b),!0):void 0}function Sc(a,b,c,d){var h,g,j,i,k,e=[],f=" = "+c+".";for(g=a.length;h=a[--g];)for(i=h.split("."),k=i[0];j=i.shift();)b.hasOwnProperty(j)&&(e.push(k+f+k),d.observers.push({v:b,p:h}),a.splice(g,1));return e}function Wc(a){var b,c,d,e,g,f;if(a=a.trim(),b=Uc.get(a))return b.concat();for(c=Qc(a),d={},e=[],f=0;g=c[f++];)d[g]||(d[g]=1,e.push(g));return Uc.put(a,e).concat()}function Xc(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,d=c.filters;for("string"==typeof d&&d.trim()&&!c._filters&&(c._filters=cd(d.trim())),e=Wc(a),f=new Date-0,g=[],h=[],i=[],c.observers=[],j=0,k=b.length;k>j;j++)e.length&&(l="vm"+f+"_"+j,h.push(l),i.push(b[j]),g.push.apply(g,Sc(e,b[j],l,c)));return c.args=i,m=c.type,n=b.map(function(a){return String(a.$id).replace(Tc,"$1")})+a+m,(o=Vc.get(n))?("duplex"===m&&(p=Vc.get(n+"setter"),c.setter=p.apply(p,c.args)),c.getter=o):(g.length||g.push("fix"+f),"duplex"===m&&(q={},g.forEach(function(a){var b=a.split("=");q[b[0].trim()]=b[1].trim()}),a=a.replace(/[\$\w]+/,function(a){return q[a]?q[a]:a}),r=z(h.concat("'use strict';return function(vvv){"+a+" = vvv\n}\n")),Vc.put(n+"setter",r),c.setter=r.apply(r,c.args)),"on"===m?(-1===a.indexOf("(")?a+=".call(this, $event)":a=a.replace("(",".call(this,"),h.push("$event"),a="\nreturn "+a+";",s=a.lastIndexOf("\nreturn"),t=a.slice(0,s),u=a.slice(s),a=t+"\n"+u):a="\nreturn "+a+";",o=z(h.concat("'use strict';\nvar "+g.join(",\n")+a)),Vc.put(n,o))}function Yc(a){var c,b=gb.test(a);return b?(c=Ld(a),1===c.length?c[0].expr:c.map(function(a){return a.type?"("+a.expr+")":ed(a.expr)}).join(" + ")):a}function cd(a){return a=a.replace(Zc,"").replace($c,function(){return"],|"}).replace(_c,function(a,b){return"["+ed(b)}).replace(ad,function(){return'"],["'}).replace(bd,function(){return'",'})+"]",z(["return ["+a+"]"])()}function gd(a,b,c){var d=setTimeout(function(){var e=a.innerHTML;clearTimeout(d),e===c?b():gd(a,b,e)})}function hd(a,b){var c=a.getAttribute("avalonctrl")||b.$id;a.setAttribute("avalonctrl",c),b.$events&&(b.$events.expr=a.tagName+'[avalonctrl="'+c+'"]')}function jd(a,b){for(var d,c=0;d=a[c++];)d.vmodels=b,M[d.type].init(d),avalon.injectBinding(d),d.getter&&1===d.element.nodeType&&d.element.removeAttribute(d.name);a.length=0}function pd(a,b){return a.priority-b.priority}function sd(a,b){var f,e,g,h,c=a.attributes,d={};for(e=0;f=c[e++];)g=f.name,f.specified&&!qd.test(g)&&(h=nc(f.name),d[h]=/^on\-[\w-]+$/.test(g)?id(a,g,b):qc(f.value));return d}function td(a,b,c){var e,f,g,j,h,k,l,m,n,o,p,q,r,s,t,d=!0;if(b.length){for(e=Bd?Bd(a):a.attributes,f=[],g={},h=0;j=e[h++];)k=j.name,g[k]||(g[k]=1,j.specified&&(c=k.match(md))&&(l=c[1],m=c[2]||"",n=j.value,nd[l]?(m=l,l="on"):od[l]&&(m=l,l="attr",k="ms-"+l+"-"+m,i("warning!请改用"+k+"代替"+j.name+"!")),M[l]&&(o=n.replace(ld,""),p=n!==o,q={type:l,param:m,element:a,name:k,expr:o,oneTime:p,uniqueNumber:j.name+"-"+Zb(a),priority:(M[l].priority||10*l.charCodeAt(0))+(Number(m.replace(/\D/g,""))||0)},"html"===l||"text"===l?(r=Kd(n).filters,q.expr=q.expr.replace(r,""),q.filters=r.replace(Fd,function(){return q.type="html",q.group=1,""}).trim()):"duplex"===l?s=k:"ms-if-loop"===k?q.priority+=100:"ms-attr-value"===k&&(t=k),f.push(q))));if(f.length){for(f.sort(pd),s&&t&&"INPUT"===a.nodeName&&"text"===a.type&&i("warning!一个控件不能同时定义ms-attr-value与"+s),h=0;q=f[h];h++){if(l=q.type,ud.test(l))return jd(f.slice(0,h+1),b);d&&(d=!vd.test(l))}jd(f,b)}}d&&!fd[a.tagName]&&(Td(a)?a.msResolved:1)&&(kd&&kd(a),Cd(a,b))}function Cd(a,b){var c=avalon.slice(a.childNodes);Dd(c,b)}function Dd(a,b){var d,c,e,f,g,h;for(c=0;d=a[c++];)switch(d.nodeType){case 1:e=d,!e.msResolved&&e.parentNode&&1===e.parentNode.nodeType&&(f=Td(e),f&&(g=e.localName?e.localName.replace(f+":",""):e.nodeName,h=f+":"+nc(g),Pd.push({library:f,element:e,fullName:h,widget:g,vmodels:b,name:"widget"}),avalon.components[h]&&function(a){setTimeout(function(){avalon.component(a)})}(h))),Ed(d,b),d.msHasEvent&&avalon.fireDom(d,"datasetchanged",{bubble:d.msHasEvent});break;case 3:gb.test(d.nodeValue)&&Md(d,b,c)}}function Ed(a,b,c){var e,f,g,h,d=a.getAttribute("ms-skip");if(!a.getAttributeNode)return i("warning "+a.tagName+" no getAttributeNode method");if(e=a.getAttributeNode("ms-important"),f=a.getAttributeNode("ms-controller"),"string"!=typeof d){if(c=e||f){if(g=avalon.vmodels[c.value],!g)return;b=c===e?[g]:[g].concat(b),h=c.name,a.removeAttribute(h),avalon(a).removeClass(h),hd(a,g)}td(a,b)}}function Kd(a){var b,c;return a.indexOf("|")>0&&(b=a.replace(Jd,function(a){return Array(a.length+1).join("1")}),c=b.replace(Gd,"ᄢ㍄").indexOf("|"),c>-1)?{type:"text",filters:a.slice(c).trim(),expr:a.slice(0,c)}:{type:"text",expr:a,filters:""}}function Ld(a){for(var c,e,b=[],d=0;;){if(e=a.indexOf(eb,d),-1===e)break;if(c=a.slice(d,e),c&&b.push({expr:c}),d=e+eb.length,e=a.indexOf(fb,d),-1===e)break;c=a.slice(d,e),c&&b.push(Kd(c,d)),d=e+fb.length}return c=a.slice(d),c&&b.push({expr:c}),b}function Md(a,b,c){var h,g,i,d=[],f=Ld(a.data);if(f.length){for(g=0;h=f[g++];)i=e.createTextNode(h.expr),h.type&&(h.expr=h.expr.replace(ld,function(){return h.oneTime=!0,""}),h.element=i,h.filters=h.filters.replace(Fd,function(){return h.type="html",""}),h.pos=1e3*c+g,d.push(h)),w.appendChild(i);a.parentNode.replaceChild(w,a),d.length&&jd(d,b)}}function Sd(a,b){var d,c,e;if(b)for(c=0;d=a[c++];)if(d.hasOwnProperty(b)&&"object"==typeof d[b])return e=d[b],e.$model||e;return{}}function Td(a){var b,c;return a.scopeName&&"HTML"!==a.scopeName?a.scopeName:(b=a.nodeName.toLowerCase(),c=b.indexOf(":"),c>0?b.slice(0,c):void 0)}function be(a){return null==a?"":a}function ce(a,b,c){return b.param.replace(m,function(d){var e=avalon.duplexHooks[d];e&&"function"==typeof e[c]&&(a=e[c](a,b))}),a}function fe(){var a,b;for(a=ee.length-1;a>=0;a--)b=ee[a],b()===!1&&ee.splice(a,1);ee.length||clearInterval(de)}function he(a){var d,b=0/0,c=0/0;return a.setSelectionRange?(b=a.selectionStart,c=a.selectionEnd):document.selection&&document.selection.createRange&&(d=document.selection.createRange(),b=0-d.duplicate().moveStart("character",-1e5),c=b+d.text.length),{start:b,end:c}}function ie(a,b,c){if(a.value&&!a.readOnly)if(a.createTextRange){var d=a.createTextRange();d.collapse(!0),d.moveStart("character",b),d.select()}else a.selectionStart=b,a.selectionEnd=c}function qe(a,b){var c,d,e;return a&&1===a.nodeType?(b?(c=b.effectName,d=b.effectDriver):(c=a.getAttribute("data-effect-name"),d=a.getAttribute("data-effect-driver")),c&&d?(e=pe.pop()||new ue,e.el=a,e.driver=d,e.useCss="j"!==d,e.useCss&&(b&&avalon(a).addClass(b.effectClass),e.cssEvent="t"===d?le:me),e.name=c,e.callbacks=avalon.effects[c]||{},e):null):null}function re(a,b){var d,c=a.getAttribute("data-effect-name");c&&(b.effectName=c,b.effectDriver=a.getAttribute("data-effect-driver"),d=+a.getAttribute("data-effect-stagger"),b.effectLeaveStagger=+a.getAttribute("data-effect-leave-stagger")||d,b.effectEnterStagger=+a.getAttribute("data-effect-enter-stagger")||d,b.effectClass=a.className||0/0)}function se(a){return a.replace(/^[\S]/g,function(a){return a.toUpperCase()})}function ue(){}function ve(a,b){var c=a.callbacks[b+"Class"];return"string"==typeof c?c:"function"==typeof c?c():a.name+"-"+b}function we(a,b,c){var d=a.callbacks[b];d&&d.call(a,a.el,c)}function Ce(a,b,c){var g,f,d=a.templateCache&&a.templateCache[b];if(d){for(f=e.createDocumentFragment();g=d.firstChild;)f.appendChild(g);return f}return avalon.parseHTML(c)}function De(a){var c,d,b=e.createDocumentFragment();for(c=0,d=a.length;d>c;c++)b.appendChild(a[c]);return b}function Ge(a,b,c){for(var e,d=0;e=a[d++];)e.className===c.effectClass&&avalon.effect.apply(e,b,A,A,c)}function He(a,b,c){return a?setTimeout(b,++c*a):b(),c}function Ie(a,b){for(var i,c=w.cloneNode(!1),d=a,e=d.nodeValue,f=b&&Math.max(+b.staggerIndex,0),g=avalon.slice(d.parentNode.childNodes),h=g.indexOf(d);;){if(i=g[--h],!i||0===String(i.nodeValue).indexOf(e))break;b&&i.className===b.effectClass?(a=i,function(a){b.staggerIndex=He(b.effectLeaveStagger,function(){avalon.effect.apply(a,0,A,function(){c.appendChild(a)},b)},f)}(i)):c.insertBefore(i,c.firstChild)}return c.appendChild(d),c}function Je(a,b,c,d,e){var h,i,f=a.template.cloneNode(!0),g=avalon.slice(f.childNodes);f.appendChild(c.$anchor),e&&b.appendChild(f),h=[c].concat(a.vmodels),i={nodes:g,vmodels:h,content:f},d.push(i)}function Ke(a){var b="object"===a.xtype?Qe:Me,c=b(a),d=c.$anchor||(c.$anchor=a.element.cloneNode(!1));return d.nodeValue=a.signature,c.$outer=a.$outer,c}function Me(a,b){var d,e,f,c=a.param||"el";for(d=0,e=Le.length;e>d;d++)if(f=Le[d],f&&f.hasOwnProperty(c)){Le.splice(d,1),b=f;break}return b||(b=Ne(c)),b}function Ne(a){var c,d,b={$outer:{},$index:0,$oldIndex:0,$anchor:null,$first:!1,$last:!1,$remove:avalon.noop};return b[a]=0/0,c={$last:1,$first:1,$index:1},c[a]=1,d=wb(b,{force:c}),d.$id=C("$proxy$each"),d}function Oe(a,b,c){if("array"===c){a.$remove=function(){b.$repeat.removeAt(a.$index)};var d=b.param;a.$watch(d,function(c){var d=a.$index;b.$repeat[d]=c})}else a.$watch("$val",function(c){b.$repeat[a.$key]=c})}function Qe(){return Pe.pop()||Re()}function Re(){var a=wb({$key:"",$val:0/0,$index:0,$oldIndex:0,$outer:{},$anchor:null},{force:{$key:1,$val:1,$index:1}});return a.$id=C("$proxy$with"),a}function Se(a,b,c){var e,f,g,d=a[b];if(d){e=0===d.$id.indexOf("$proxy$each")?Le:Pe,d.$outer={};for(f in d.$events)g=d.$events[f],Array.isArray(g)&&(g.length=0,f===c?d[c]=0/0:"$val"===f&&(d.$val=0/0));e.unshift(d)>db.maxRepeatSize&&e.pop(),delete a[b]}}function Te(a,b){var d,c="_"+a;return Te[c]||(d=e.createElement(a),v.appendChild(d),b=u?getComputedStyle(d,null).display:d.currentStyle.display,v.removeChild(d),Te[c]=b),Te[c]}function $e(a,b,c,d){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var e=isFinite(+a)?+a:0,f=isFinite(+b)?Math.abs(b):3,g=d||",",h=c||".",i="",j=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};return i=(f?j(e,f):""+Math.round(e)).split("."),i[0].length>3&&(i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,g)),(i[1]||"").length<f&&(i[1]=i[1]||"",i[1]+=new Array(f-i[1].length+1).join("0")),i.join(h)}function hf(){try{v.doScroll("left"),gf()}catch(a){setTimeout(hf)}}var h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,C,E,F,H,I,K,L,M,O,P,Q,R,S,T,X,Y,$,ab,bb,cb,eb,fb,gb,hb,ib,jb,lb,qb,rb,sb,tb,ub,Cb,Gb,Hb,Jb,Kb,Lb,Mb,Qb,Vb,Wb,Xb,Yb,cc,dc,ec,fc,gc,hc,ic,jc,oc,rc,sc,tc,uc,vc,xc,yc,zc,Ac,Bc,Cc,Dc,Ec,Fc,Gc,Hc,Kc,Lc,Mc,Nc,Oc,Pc,Tc,Uc,Vc,Zc,$c,_c,ad,bd,dd,ed,fd,id,kd,ld,md,nd,od,qd,ud,vd,wd,xd,yd,zd,Ad,Bd,Fd,Gd,Jd,Nd,Od,Pd,Qd,Rd,Ud,Vd,Wd,Xd,Yd,Zd,$d,_d,de,ee,ge,je,ke,le,me,ne,oe,pe,te,xe,ye,ze,Ae,Be,Ee,Fe,Le,Pe,Ue,Ve,We,Xe,Ye,Ze,_e,af,bf,cf,df,ff,ef,gf,jf,kf,d=new Date-0,e=b.document,f=e.getElementsByTagName("head")[0],g=f.insertBefore(document.createElement("avalon"),f.firstChild);g.innerHTML="X<style id='avalonStyle'>.avalonHide{ display: none!important }</style>",g.setAttribute("ms-skip","1"),g.className="avalonHide",h=/\[native code\]/,j="$"+d,k={},l=/[^, ]+/g,m=/\w+/g,n=/^\[object SVG\w*Element\]$/,o=/^\[object (?:Window|DOMWindow|global)\]$/,p=Object.prototype,q=p.hasOwnProperty,r=p.toString,s=Array.prototype,t=s.slice,u=b.dispatchEvent,v=e.documentElement,w=e.createDocumentFragment(),x=e.createElement("div"),y={},"Boolean Number String Function Array Date RegExp Object Error".replace(l,function(a){y["[object "+a+"]"]=a.toLowerCase()}),C=function(a){return a=a||"avalon",String(Math.random()+Math.random()).replace(/\d\.\d{4}/,a)},E=D(),avalon=function(a){return new avalon.init(a)},avalon.nextTick=new function(){function e(){var b,a=d.length;for(b=0;a>b;b++)d[b]();d=d.slice(a)}var d,f,g,a=b.setImmediate,c=b.MutationObserver;return a?a.bind(b):(d=[],c?(f=document.createTextNode("avalon"),new c(e).observe(f,{characterData:!0}),g=!1,function(a){d.push(a),g=!g,f.data=g}):function(a){setTimeout(a,4)})},avalon.init=function(a){this[0]=this.element=a},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?y[r.call(a)]||"object":typeof a},F="object"==typeof alert?function(a){try{return/^\s*\bfunction\b/.test(a+"")}catch(b){return!1}}:function(a){return"[object Function]"===r.call(a)},avalon.isFunction=F,avalon.isWindow=function(a){return a?a==a.document&&a.document!=a:!1},G(b)&&(avalon.isWindow=G);for(H in avalon({}))break;I="0"!==H,avalon.isPlainObject=function(a,b){if(!a||"object"!==avalon.type(a)||a.nodeType||avalon.isWindow(a))return!1;try{if(a.constructor&&!q.call(a,"constructor")&&!q.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(I)for(b in a)return q.call(a,b);for(b in a);return void 0===b||q.call(a,b)},h.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(a){return"[object Object]"===r.call(a)&&Object.getPrototypeOf(a)===p}),avalon.mix=avalon.fn.mix=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[1]||{},h++),"object"==typeof g||F(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a){c=g[b];try{d=a[b]}catch(k){continue}g!==d&&(j&&d&&(avalon.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,f=c&&Array.isArray(c)?c:[]):f=c&&avalon.isPlainObject(c)?c:{},g[b]=avalon.mix(j,f,d)):void 0!==d&&(g[b]=d))}return g},avalon.mix({rword:l,subscribers:j,version:1.55,ui:{},log:i,slice:u?function(a,b,c){return t.call(a,b,c)}:function(a,b,c){var f,d=[],e=a.length;if(void 0===c&&(c=e),"number"==typeof c&&isFinite(c))for(b=J(b,e),c=J(c,e),f=b;c>f;++f)d[f-b]=a[f];return d},noop:A,error:function(a,b){throw(b||Error)(a)},oneObject:B,range:function(a,b,c){c||(c=1),null==b&&(b=a||0,a=0);for(var d=-1,e=Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a,a+=c;return f},eventHooks:{},bind:function(a,b,c,d){var g,e=avalon.eventHooks,f=e[b];return"object"==typeof f&&(b=f.type||b,d=f.phase||!!d,c=f.fn?f.fn(a,c):c),g=u?c:function(b){c.call(a,_(b))},u?a.addEventListener(b,g,d):a.attachEvent("on"+b,g),g},unbind:function(a,b,c,d){var e=avalon.eventHooks,f=e[b],g=c||A;"object"==typeof f&&(b=f.type||b,d=f.phase||!!d),u?a.removeEventListener(b,g,d):a.detachEvent("on"+b,g)},css:function(a,b,c){var e,d,f;if(a instanceof avalon&&(a=a[0]),d=/[_-]/.test(b)?nc(b):b,b=avalon.cssName(d)||d,void 0===c||"boolean"==typeof c)return e=xc[d+":get"]||xc["@:get"],"background"===b&&(b="backgroundColor"),f=e(a,b),c===!0?parseFloat(f)||0:f;if(""===c)a.style[b]="";else{if(null==c||c!==c)return;isFinite(c)&&!avalon.cssNumber[d]&&(c+="px"),e=xc[d+":set"]||xc["@:set"],e(a,b,c)}},each:function(a,b){var c,d;if(a)if(c=0,N(a))for(d=a.length;d>c&&b(c,a[c])!==!1;c++);else for(c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)break},getWidgetData:function(a,b){var e,c=avalon(a).data(),d={};for(e in c)0===e.indexOf(b)&&(d[e.replace(b,"").replace(/\w/,function(a){return a.toLowerCase()})]=c[e]);return d},Array:{ensure:function(a,b){return-1===a.indexOf(b)?a.push(b):void 0},removeAt:function(a,b){return!!a.splice(b,1).length},remove:function(a,b){var c=a.indexOf(b);return~c?avalon.Array.removeAt(a,c):!1}}}),K=avalon.bindingHandlers={},L=avalon.bindingExecutors={},M=avalon.directives={},avalon.directive=function(a,b){return K[a]=b.init=b.init||A,L[a]=b.update=b.update||A,M[a]=b},O=new function(){function a(a){this.size=0,this.limit=a,this.head=this.tail=void 0,this._keymap={}}var b=a.prototype;return b.put=function(a,b){var c={key:a,value:b};return this._keymap[a]=c,this.tail?(this.tail.newer=c,c.older=this.tail):this.head=c,this.tail=c,this.size===this.limit?this.shift():this.size++,b},b.shift=function(){var a=this.head;a&&(this.head=this.head.newer,this.head.older=a.newer=a.older=this._keymap[a.key]=void 0,delete this._keymap[a.key])},b.get=function(a){var b=this._keymap[a];if(void 0!==b)return b===this.tail?b.value:(b.newer&&(b===this.head&&(this.head=b.newer),b.newer.older=b.older),b.older&&(b.older.newer=b.newer),b.newer=void 0,b.older=this.tail,this.tail&&(this.tail.newer=b),this.tail=b,b.value)},a},"司徒正美".trim||(P=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,String.prototype.trim=function(){return this.replace(P,"")}),Q=!{toString:null}.propertyIsEnumerable("toString"),R=function(){}.propertyIsEnumerable("prototype"),S=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],T=S.length,Object.keys||(Object.keys=function(a){var d,e,f,g,h,i,b=[],c=R&&"function"==typeof a;if("string"==typeof a||a&&a.callee)for(d=0;d<a.length;++d)b.push(String(d));else for(e in a)c&&"prototype"===e||!q.call(a,e)||b.push(String(e));if(Q)for(f=a.constructor,g=f&&f.prototype===a,h=0;T>h;h++)i=S[h],g&&"constructor"===i||!q.call(a,i)||b.push(i);return b}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===r.call(a)}),A.bind||(Function.prototype.bind=function(a){if(arguments.length<2&&void 0===a)return this;var b=this,c=arguments;return function(){var e,d=[];for(e=1;e<c.length;e++)d.push(c[e]);for(e=0;e<arguments.length;e++)d.push(arguments[e]);return b.apply(a,d)}}),h.test([].map)||avalon.mix(s,{indexOf:function(a,b){var c=this.length,d=~~b;for(0>d&&(d+=c);c>d;d++)if(this[d]===a)return d;return-1},lastIndexOf:function(a,b){var c=this.length,d=null==b?c-1:b;for(0>d&&(d=Math.max(0,c+d));d>=0;d--)if(this[d]===a)return d;return-1},forEach:U("","_",""),filter:U("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:U("r=[],","r[i]=_","return r"),some:U("","if(_)return true","return false"),every:U("","if(!_)return false","return true")}),avalon.contains=V,e.contains||(e.contains=function(a){return V(e,a)}),b.SVGElement&&(e.createTextNode("x").contains||(Node.prototype.contains=function(a){return!!(16&this.compareDocumentPosition(a))}),X="http://www.w3.org/2000/svg",Y=e.createElementNS(X,"svg"),Y.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />',n.test(Y.firstChild)||Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:W,set:function(a){var f,b=this.tagName.toLowerCase(),c=this.parentNode,d=avalon.parseHTML(a);"svg"===b?c.insertBefore(d,this):(f=e.createDocumentFragment(),Z(d,f),c.insertBefore(f,this)),c.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var a=this.outerHTML,b=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),c=new RegExp("</"+this.nodeName+">$","i");return a.replace(b,"").replace(c,"")},set:function(a){if(avalon.clearHTML){avalon.clearHTML(this);var b=avalon.parseHTML(a);Z(b,this)}}}})),!v.outerHTML&&b.HTMLElement&&HTMLElement.prototype.__defineGetter__("outerHTML",W),$=/^(?:mouse|contextmenu|drag)|click/,ab=avalon.eventHooks,"onmouseenter"in v||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){ab[a]={type:b,fn:function(b,c){return function(d){var e=d.relatedTarget;return e&&(e===b||16&b.compareDocumentPosition(e))?void 0:(delete d.type,d.type=a,c.call(b,d))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(a,c){b[a]&&!ab.animationend&&(ab.animationend={type:c})}),"oninput"in e.createElement("input")||(ab.input={type:"propertychange",deel:function(a,b){return function(c){return"value"===c.propertyName?(c.type="input",b.call(a,c)):void 0}}}),void 0===e.onmousewheel&&(bb=void 0!==e.onwheel?"wheel":"DOMMouseScroll",cb="wheel"===bb?"deltaY":"detail",ab.mousewheel={type:bb,fn:function(a,b){return function(c){c.wheelDeltaY=c.wheelDelta=c[cb]>0?-120:120,c.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(c,"type",{value:"mousewheel"}),b.call(a,c)}}}),jb=/[-.*+?^${}()|[\]\/\\]/g,lb={interpolate:function(a){var c,d;if(eb=a[0],fb=a[1],eb===fb)throw new SyntaxError("openTag!==closeTag");db.openTag=eb,db.closeTag=fb,c=kb(eb),d=kb(fb),gb=new RegExp(c+"(.*?)"+d),hb=new RegExp(c+"(.*?)"+d,"g"),ib=new RegExp(c+".*?"+d+"|\\sms-")}},db.async=!0,db.debug=!0,db.plugins=lb,db.plugins["interpolate"](["{{","}}"]),db.paths={},db.shim={},db.maxRepeatSize=100,avalon.config=db,qb=avalon.vmodels={},avalon.define=function(a){var c,b=a.$id;return b||i("warning: vm必须指定$id"),c=wb(a),c.$id=b,qb[b]=c},rb=B("$id,$watch,$fire,$events,$model,$skipArray,$active,$pathname,$up,$track,$accessors,$ups"),sb=Object.defineProperty,tb=!0;try{sb({},"_",{value:"x"}),ub=Object.defineProperties}catch(vb){tb=!1}if(Cb=h.test(Object.key)?Object.key:function(a){var c,b=[];for(c in a)a.hasOwnProperty(c)&&!rb[c]&&b.push(c);return b},Gb={get:function(){return Fb(this)},set:A,enumerable:!1,configurable:!0},tb||("__defineGetter__"in avalon&&(sb=function(a,b,c){return"value"in c&&(a[b]=c.value),"get"in c&&a.__defineGetter__(b,c.get),"set"in c&&a.__defineSetter__(b,c.set),a},ub=function(a,b){for(var c in b)b.hasOwnProperty(c)&&sb(a,c,b[c]);return a}),E&&(Hb={},b.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),ub=function(a,c,e){var g,h,i,j,f=[];f.push("\r\n	Private [__data__], [__proxy__]","	Public Default Function [__const__](d"+d+", p"+d+")","		Set [__data__] = d"+d+": set [__proxy__] = p"+d,"		Set [__const__] = Me","	End Function"),g={};for(a in c)g[a]=!0,f.push("	Public Property Let ["+a+"](val"+d+")",'		Call [__proxy__](Me,[__data__], "'+a+'", val'+d+")","	End Property","	Public Property Set ["+a+"](val"+d+")",'		Call [__proxy__](Me,[__data__], "'+a+'", val'+d+")","	End Property","	Public Property Get ["+a+"]","	On Error Resume Next","		Set["+a+'] = [__proxy__](Me,[__data__],"'+a+'")',"	If Err.Number <> 0 Then","		["+a+'] = [__proxy__](Me,[__data__],"'+a+'")',"	End If","	On Error Goto 0","	End Property");
for(a in e)g[a]!==!0&&(g[a]=!0,f.push("	Public ["+a+"]"));for(a in rb)g[a]!==!0&&(g[a]=!0,f.push("	Public ["+a+"]"));return f.push("	Public [hasOwnProperty]"),f.push("End Class"),h=f.join("\r\n"),i=Hb[h],i||(i=C("VBClass"),b.parseVB("Class "+i+h),b.parseVB(["Function "+i+"Factory(a, b)","	Dim o","	Set o = (New "+i+")(a, b)","	Set "+i+"Factory = o","End Function"].join("\r\n")),Hb[h]=i),j=b[i+"Factory"](c,Ib)})),Jb=["push","pop","shift","unshift","splice"],Kb=Array.prototype,Lb={notify:function(){nb.call(this.$up,this.$pathname)},set:function(a,b){if(a>>>0===a&&this[a]!==b){if(a>this.length)throw Error(a+"set方法的第一个参数不能大于原数组长度");nb.call(this.$up,this.$pathname+".*",[b,this[a]]),this.splice(a,1,b)}},contains:function(a){return-1!==this.indexOf(a)},ensure:function(a){return this.contains(a)||this.push(a),this},pushArray:function(a){return this.push.apply(this,a)},remove:function(a){return this.removeAt(this.indexOf(a))},removeAt:function(a){return a>>>0===a?this.splice(a,1):[]},size:function(){return this._.length},removeAll:function(a){var b,c;if(Array.isArray(a))for(b=this.length-1;b>=0;b--)-1!==a.indexOf(this[b])&&(Mb.call(this.$track,b,1),Mb.call(this,b,1));else if("function"==typeof a)for(b=this.length-1;b>=0;b--)c=this[b],a(c,b)&&(Mb.call(this.$track,b,1),Mb.call(this,b,1));else Mb.call(this.$track,0,this.length),Mb.call(this,0,this.length);u||(this.$model=Fb(this)),this.notify(),this._.length=this.length},clear:function(){return this.removeAll()}},Mb=Kb.splice,Jb.forEach(function(a){var b=Kb[a];Lb[a]=function(){var d,e,f,c=[];for(d=0,e=arguments.length;e>d;d++)c[d]=Bb(arguments[d],0,1,1);return f=b.apply(this,c),Pb(this.$track,a,c),u||(this.$model=Fb(this)),this.notify(),this._.length=this.length,f}}),"sort,reverse".replace(l,function(a){Lb[a]=function(){var g,h,i,j,k,b=this.concat(),c=this,d=Math.random(),e=[],f=!1;for(Kb[a].apply(c,arguments),g=0,h=b.length;h>g;g++)i=c[g],j=b[g],i===j?e.push(g):(k=b.indexOf(i),e.push(k),b[k]=d,f=!0);return f&&(Nb(this.$track,e),u||(this.$model=Fb(this)),this.notify()),this}}),Qb=function(){var b,a=[];return{begin:function(c){a.push(b),b=c},end:function(){b=a.pop()},collectDependency:function(a){b&&b.callback(a)}}}(),avalon.injectBinding=function(a){a.handler=a.handler||M[a.type].update||A,a.update=function(){var d,e,c,f,g,h,k,b=!1;a.getter||(b=!0,Qb.begin({callback:function(b){Tb(b,a)}}),a.getter=Xc(a.expr,a.vmodels,a),a.observers.forEach(function(b){b.v.$watch(b.p,a)}),delete a.observers);try{if(c=a.fireArgs,delete a.fireArgs,c?(d=c[0],e=c[1]):d="on"===a.type?a.getter+"":a.getter.apply(0,a.args),e="undefined"==typeof e?a.oldValue:e,a._filters&&(d=_e.$filter.apply(0,[d].concat(a._filters))),a.signature){if(f=avalon.type(d),"array"!==f&&"object"!==f)throw Error("warning:"+a.expr+"只能是对象或数组");a.xtype=f,g=Ub(a.proxies||[],f),h=d.$track||("array"===f?Ob(d.length):Object.keys(d)),a.track=h,g!==h.join(";")&&(a.handler(d,e),a.oldValue=1)}else(Array.isArray(d)?d.length===(e&&e.length):1)?"oldValue"in a&&d===e||(a.handler(d,e),a.oldValue=d):(a.handler(d,e),a.oldValue=d.concat())}catch(j){delete a.getter,i("warning:exception throwed in [avalon.injectBinding] ",j),k=a.element,k&&3===k.nodeType&&(k.nodeValue=eb+(a.oneTime?"::":"")+a.expr+fb)}finally{b&&Qb.end()}},a.update()},Vb=0,Wb=avalon.$$subscribers=[],Xb=new Date,Yb={},cc={area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],col:[2,"<table><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table>","</table>"],td:[3,"<table><tr>","</tr></table>"],g:[1,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',"</svg>"],_default:u?[0,"",""]:[1,"X<div>","</div>"]},cc.th=cc.td,cc.optgroup=cc.option,cc.tbody=cc.tfoot=cc.colgroup=cc.caption=cc.thead,String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(l,function(a){cc[a]=cc.g}),dc=/<([\w:]+)/,ec=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,fc=u?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/gi,gc=B(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),hc=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,ic=e.createElement("script"),jc=/<|&#?\w+;/,avalon.parseHTML=function(a){var g,h,c,d,f,i,k,j,l,m,b=w.cloneNode(!1);if("string"!=typeof a)return b;if(!jc.test(a))return b.appendChild(e.createTextNode(a)),b;if(a=a.replace(ec,"<$1></$2>").trim(),c=(dc.exec(a)||["",""])[1].toLowerCase(),d=cc[c]||cc._default,f=x,u||(a=a.replace(fc,"<br class=msNoScope>$1")),f.innerHTML=d[1]+a+d[2],i=f.getElementsByTagName("script"),i.length)for(j=0;k=i[j++];)gc[k.type]&&(h=ic.cloneNode(!1),s.forEach.call(k.attributes,function(a){a&&a.specified&&(h[a.name]=a.value,h.setAttribute(a.name,a.value))}),h.text=k.text,k.parentNode.replaceChild(h,k));if(!u){if(l="X<div>"===d[1]?f.lastChild.firstChild:f.lastChild,l&&"TABLE"===l.tagName&&"tbody"!==c)for(i=l.childNodes,j=0;k=i[j++];)if("TBODY"===k.tagName&&!k.innerHTML){l.removeChild(k);break}for(i=f.getElementsByTagName("br"),m=i.length;k=i[--m];)"msNoScope"===k.className&&k.parentNode.removeChild(k);for(i=f.all,j=0;k=i[j++];)kc(k)&&lc(k)}for(j=d[0];j--;f=f.lastChild);for(;g=f.firstChild;)b.appendChild(g);return b},avalon.innerHTML=function(a,b){if(!u&&!fc.test(b)&&!hc.test(b))try{return a.innerHTML=b,void 0}catch(c){}var d=this.parseHTML(b);this.clearHTML(a).appendChild(d)},avalon.clearHTML=function(a){for(a.textContent="";a.firstChild;)a.removeChild(a.firstChild);return a},oc={_toString:function(){var a=this.node,b=a.className,c="string"==typeof b?b:b.baseVal;return c.split(/\s+/).join(" ")},_contains:function(a){return(" "+this+" ").indexOf(" "+a+" ")>-1},_add:function(a){this.contains(a)||this._set(this+" "+a)},_remove:function(a){this._set((" "+this+" ").replace(" "+a+" "," "))},__set:function(a){a=a.trim();var b=this.node;n.test(b)?b.setAttribute("class",a):b.className=a}},"add,remove".replace(l,function(a){avalon.fn[a+"Class"]=function(b){var c=this[0];return b&&"string"==typeof b&&c&&1===c.nodeType&&b.replace(/\S+/g,function(b){pc(c)[a](b)}),this}}),avalon.fn.mix({hasClass:function(a){var b=this[0]||{};return 1===b.nodeType&&pc(b).contains(a)},toggleClass:function(a,b){for(var c,g,d=0,e=String(a).split(/\s+/),f="boolean"==typeof b;c=e[d++];)g=f?b:!this.hasClass(c),this[g?"addClass":"removeClass"](c);return this},attr:function(a,b){return 2===arguments.length?(this[0].setAttribute(a,b),this):this[0].getAttribute(a)},data:function(a,b){var c,d;switch(a="data-"+mc(a||""),arguments.length){case 2:return this.attr(a,b),this;case 1:return c=this.attr(a),qc(c);case 0:return d={},s.forEach.call(this[0].attributes,function(b){b&&(a=b.name,a.indexOf("data-")||(a=nc(a.slice(5)),d[a]=qc(b.value)))}),d}},removeData:function(a){return a="data-"+mc(a),this[0].removeAttribute(a),this},css:function(a,b){var c,d;if(avalon.isPlainObject(a))for(c in a)avalon.css(this,c,a[c]);else d=avalon.css(this,a,b);return void 0!==d?d:this},position:function(){var a,b,c=this[0],d={top:0,left:0};if(c)return"fixed"===this.css("position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),"HTML"!==a[0].tagName&&(d=a.offset()),d.top+=avalon.css(a[0],"borderTopWidth",!0),d.left+=avalon.css(a[0],"borderLeftWidth",!0),d.top-=a.scrollTop(),d.left-=a.scrollLeft()),{top:b.top-d.top-avalon.css(c,"marginTop",!0),left:b.left-d.left-avalon.css(c,"marginLeft",!0)}},offsetParent:function(){for(var a=this[0].offsetParent;a&&"static"===avalon.css(a,"position");)a=a.offsetParent;return avalon(a||v)},bind:function(a,b,c){return this[0]?avalon.bind(this[0],a,b,c):void 0},unbind:function(a,b,c){return this[0]&&avalon.unbind(this[0],a,b,c),this},val:function(a){var c,d,e,f,b=this[0];if(b&&1===b.nodeType)if(c=0===arguments.length,d=c?":get":":set",e=Lc[Jc(b)+d])f=e(b,a);else{if(c)return(b.value||"").replace(/\r/g,"");b.value=a}return c?f:this}}),rc=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,sc=/^[\],:{}\s]*$/,tc=/(?:^|:|,)(?:\s*\[)+/g,uc=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,vc=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,avalon.parseJSON=b.JSON?JSON.parse:function(a){if("string"==typeof a){if(a=a.trim(),a&&sc.test(a.replace(uc,"@").replace(vc,"]").replace(tc,"")))return new Function("return "+a)();avalon.error("Invalid JSON: "+a)}return a},avalon.fireDom=function(a,b,c){if(e.createEvent){var d=e.createEvent("Events");d.initEvent(b,!0,!0,c),avalon.mix(d,c),a.dispatchEvent(d)}else v.contains(a)&&(d=e.createEventObject(),avalon.mix(d,c),a.fireEvent("on"+b,d))},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){avalon.fn[a]=function(c){var d=this[0]||{},e=wc(d),f="scrollTop"===a;return arguments.length?(e?e.scrollTo(f?avalon(e).scrollLeft():c,f?c:avalon(e).scrollTop()):d[a]=c,void 0):e?b in e?e[b]:v[a]:d[a]}}),xc=avalon.cssHooks={},yc=["","-webkit-","-o-","-moz-","-ms-"],zc={"float":u?"cssFloat":"styleFloat"},avalon.cssNumber=B("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(a,b,c){if(zc[a])return zc[a];b=b||v.style;for(var d=0,e=yc.length;e>d;d++)if(c=nc(yc[d]+a),c in b)return zc[a]=c;return null},xc["@:set"]=function(a,b,c){try{a.style[b]=c}catch(d){}},b.getComputedStyle?(xc["@:get"]=function(a,b){if(!a||!a.style)throw new Error("getComputedStyle要求传入一个节点 "+a);var c,d=getComputedStyle(a,null);return d&&(c="filter"===b?d.getPropertyValue(b):d[b],""===c&&(c=a.style[b])),c},xc["opacity:get"]=function(a){var b=xc["@:get"](a,"opacity");return""===b?"1":b}):(Ac=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,Bc=/^(top|right|bottom|left)$/,Cc=/alpha\([^)]*\)/i,Dc=!!b.XDomainRequest,Ec="DXImageTransform.Microsoft.Alpha",Fc={thin:Dc?"1px":"2px",medium:Dc?"3px":"4px",thick:Dc?"5px":"6px"},xc["@:get"]=function(a,b){var e,f,g,c=a.currentStyle,d=c[b];return Ac.test(d)&&!Bc.test(d)&&(e=a.style,f=e.left,g=a.runtimeStyle.left,a.runtimeStyle.left=c.left,e.left="fontSize"===b?"1em":d||0,d=e.pixelLeft+"px",e.left=f,a.runtimeStyle.left=g),"medium"===d&&(b=b.replace("Width","Style"),"none"===c[b]&&(d="0px")),""===d?"auto":Fc[d]||d},xc["opacity:set"]=function(a,b,c){var d=a.style,e=isFinite(c)&&1>=c?"alpha(opacity="+100*c+")":"",f=d.filter||"";d.zoom=1,d.filter=(Cc.test(f)?f.replace(Cc,e):f+" "+e).trim(),d.filter||d.removeAttribute("filter")},xc["opacity:get"]=function(a){var b=a.filters.alpha||a.filters[Ec],c=b&&b.enabled?b.opacity:100;return c/100+""}),"top,left".replace(l,function(a){xc[a+":get"]=function(b){var c=xc["@:get"](b,a);return/px$/.test(c)?c:avalon(b).position()[a]+"px"}}),Gc={position:"absolute",visibility:"hidden",display:"block"},Hc=/^(none|table(?!-c[ea]).+)/,"Width,Height".replace(l,function(a){var b=a.toLowerCase(),c="client"+a,d="scroll"+a,e="offset"+a;xc[b+":get"]=function(b,c,d){var g,f=-4;return"number"==typeof d&&(f=d),c="Width"===a?["Left","Right"]:["Top","Bottom"],g=b[e],2===f?g+avalon.css(b,"margin"+c[0],!0)+avalon.css(b,"margin"+c[1],!0):(0>f&&(g=g-avalon.css(b,"border"+c[0]+"Width",!0)-avalon.css(b,"border"+c[1]+"Width",!0)),-4===f&&(g=g-avalon.css(b,"padding"+c[0],!0)-avalon.css(b,"padding"+c[1],!0)),g)},xc[b+"&get"]=function(a){var d,f,e,g,c=[];for(Ic(a,c),d=xc[b+":get"](a),e=0;f=c[e++];){a=f.node;for(g in f)"string"==typeof f[g]&&(a.style[g]=f[g])}return d},avalon.fn[b]=function(f){var h,g=this[0];return 0===arguments.length?g.setTimeout?g["inner"+a]||g.document.documentElement[c]||g.document.body[c]:9===g.nodeType?(h=g.documentElement,Math.max(g.body[d],h[d],g.body[e],h[e],h[c])):xc[b+"&get"](g):this.css(b,f)},avalon.fn["inner"+a]=function(){return xc[b+":get"](this[0],void 0,-2)},avalon.fn["outer"+a]=function(a){return xc[b+":get"](this[0],void 0,a===!0?2:0)}}),avalon.fn.offset=function(){var c,d,e,f,g,h,i,j,a=this[0],b={left:0,top:0};return a&&a.tagName&&a.ownerDocument?(c=a.ownerDocument,d=c.body,e=c.documentElement,f=c.defaultView||c.parentWindow,avalon.contains(e,a)?(a.getBoundingClientRect&&(b=a.getBoundingClientRect()),g=e.clientTop||d.clientTop,h=e.clientLeft||d.clientLeft,i=Math.max(f.pageYOffset||0,e.scrollTop,d.scrollTop),j=Math.max(f.pageXOffset||0,e.scrollLeft,d.scrollLeft),{top:b.top+i-g,left:b.left+j-h}):b):b},Kc=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,Lc={"option:get":E?function(a){return Kc.test(a.outerHTML)?a.value:a.text.trim()}:function(a){return a.value},"select:get":function(a,b){for(var c,d=a.options,e=a.selectedIndex,f=Lc["option:get"],g="select-one"===a.type||0>e,h=g?null:[],i=g?e+1:d.length,j=0>e?i:g?e:0;i>j;j++)if(c=d[j],(c.selected||j===e)&&!c.disabled){if(b=f(c),g)return b;h.push(b)}return h},"select:set":function(a,b,c){var d,f,e;for(b=[].concat(b),d=Lc["option:get"],e=0;f=a.options[e++];)(f.selected=b.indexOf(d(f))>-1)&&(c=!0);c||(a.selectedIndex=-1)}},Mc={},Nc=["break,case,catch,continue,debugger,default,delete,do,else,false","finally,for,function,if,in,instanceof,new,null,return,switch,this","throw,true,try,typeof,var,void,while,with","abstract,boolean,byte,char,class,const,double,enum,export,extends","final,float,goto,implements,import,int,interface,long,native","package,private,protected,public,short,static,super,synchronized","throws,transient,volatile","arguments,let,yield,undefined"].join(","),Nc.replace(/\w+/g,function(a){Mc[a]=!0}),Oc=/[a-z_$]/i,Pc=/[\s\uFEFF\xA0]/,Tc=/(\$proxy\$[a-z]+)\d+$/,Uc=new O(218),Vc=new O(128),avalon.normalizeExpr=Yc,avalon.parseExprProxy=Xc,Zc=/\)\s*$/,$c=/\)\s*\|/g,_c=/\|\s*([$\w]+)/g,ad=/"\s*\["/g,bd=/"\s*\(/g,dd={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},ed=b.JSON&&JSON.stringify||function(a){return'"'+a.replace(/[\\\"\x00-\x1f]/g,function(a){var b=dd[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},avalon.scan=function(a,b){a=a||v;var c=b?[].concat(b):[];Ed(a,c)},fd=B("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase()),id=function(a,b,c){var f,e,d=a.getAttribute(b);if(d)for(e=0;f=c[e++];)if(f.hasOwnProperty(d)&&"function"==typeof f[d])return f[d]},kd=E&&b.MutationObserver?function(a){for(var c,d,b=a.firstChild;b;)d=b.nextSibling,3===b.nodeType?c?(c.nodeValue+=b.nodeValue,a.removeChild(b)):c=b:c=null,b=d}:0,ld=/^\s*::/,md=/ms-(\w+)-?(.*)/,nd=B("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),od=B("value,title,alt,checked,selected,disabled,readonly,enabled,href,src"),qd=/^(ms-\S+|data-\S+|on[a-z]+|id|style|class)$/,ud=/^if|widget|repeat$/,vd=/^each|with|html|include$/,u||(wd=new O(512),xd=/\s+([^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,yd=/^['"]/,zd=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/i,Ad=/&amp;/g,Bd=function(a){var c,e,f,d,g,h,i,b=a.outerHTML;if("</"===b.slice(0,2)||!b.trim())return[];if(c=b.match(zd)[0],d=[],g=wd.get(c))return g;for(;e=xd.exec(c);)f=e[2],f&&(f=(yd.test(f)?f.slice(1,-1):f).replace(Ad,"&")),h=e[1].toLowerCase(),match=h.match(md),i={name:h,specified:!0,value:f||""},d.push(i);return wd.put(c,d)}),Fd=/\|\s*html(?:\b|$)/,Gd=/\|\|/g,Jd=/(['"])(\\\1|.)+?\1/g,Nd=function(){this.queue=[]},Nd.prototype={render:function(a){if(!this.locked){this.locked=a?v.offsetHeight+10:1;var b=this;avalon.nextTick(function(){b.flush()})}},flush:function(){for(var b,a=0;b=this.queue[a++];)b.update&&b.update();this.locked=0,this.queue=[]}},Od=new Nd,Pd=[],Qd=[],Rd={$construct:function(){return avalon.mix.apply(null,arguments)},$ready:A,$init:A,$dispose:A,$container:null,$childReady:A,$replace:!1,$extend:null,$$template:function(a){return a}},avalon.components={},avalon.component=function(a,c){c&&(avalon.components[a]=avalon.mix({},Rd,c));for(var f,d=0;f=Pd[d];d++)a===f.fullName&&(Pd.splice(d,1),d--,function(c,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,x,v,z,y,A,B,D,E,F,G,H,I,J,K;if(!avalon.contains(e,f))return avalon.Array.remove(Pd,c),void 0;if(h=1,i=c.library,j=avalon.libraries[i]||Rd,!f.getAttribute("ms-attr-identifier")){for(k=sd(f,c.vmodels),l=Sd(c.vmodels,k.config||c.widget),m=k.$id||k.identifier||C(g),delete k.config,delete k.$id,delete k.identifier,n={},o=avalon.components[d.$extend],o?(avalon.mix(!0,n,o),n=o.$construct.call(f,n,{},{})):avalon.mix(!0,n,d),n=avalon.components[a].$construct.call(f,n,l,k),n.$refs={},n.$id=m,p=n.$slot,q=n.$replace,r=n.$container,s=n.$template,delete n.$slot,delete n.$replace,delete n.$container,delete n.$construct,t=avalon.define(n)||{},f.msResolved=1,t.$init(t,f),j.$init(t,f),u=f.childNodes,v={},y=0;z=u[y++];)A=1===z.nodeType&&z.getAttribute("slot")||p,A&&(v[A]?v[A].push(z):v[A]=[z]);t.$$template&&(avalon.clearHTML(f),f.innerHTML=t.$$template(s));for(y in v)if(t.hasOwnProperty(y)){if(B=v[y],B.length){for(D=w.cloneNode(!0),E=0;x=B[E++];)D.appendChild(x);t[y]=D}v[y]=null}v=null,F=f.children[0]||f.firstChild,q&&(f.parentNode.replaceChild(F,f),F.msResolved=1,G=f.style.cssText,H=f.className,f=c.element=F,f.style.cssText=G,H&&avalon(f).addClass(H)),r&&r.appendChild(f),avalon.fireDom(f,"datasetchanged",{library:i,vm:t,childReady:1}),I=0,J=avalon.bind(f,"datasetchanged",function(a){if(a.childReady&&a.library===i&&(h+=a.childReady,t!==a.vm&&(t.$refs[a.vm.$id]=a.vm,-1===a.childReady&&(I++,t.$childReady(t,f,a)),a.stopPropagation())),0===h){var d=setTimeout(function(){clearTimeout(d),t.$ready(t,f,c.vmodels),j.$ready(t,f,c.vmodels)},I?Math.max(17*I,100):17);avalon.unbind(f,"datasetchanged",J),c.rollback=function(){try{t.$dispose(t,f),j.$dispose(t,f)}catch(a){}delete avalon.vmodels[t.$id]},$b(c,Qd),b.chrome&&f.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(_b)})}}),Ed(f,[t].concat(c.vmodels)),avalon.vmodels[t.$id]=t,f.childNodes.length?K=setTimeout(function(){clearTimeout(K),avalon.fireDom(f,"datasetchanged",{library:i,vm:t,childReady:-1})},17):avalon.fireDom(f,"datasetchanged",{library:i,vm:t,childReady:-1})}}(f,avalon.components[a],f.element,f.widget))},avalon.libraries=[],avalon.library=function(a,b){e.namespaces&&e.namespaces.add(a,"http://www.w3.org/1999/xhtml"),avalon.libraries[a]=avalon.mix({$init:A,$ready:A,$dispose:A},b||{})},avalon.library("ms"),Ud=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected","contentEditable,isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(","),Vd={},Ud.replace(l,function(a){Vd[a.toLowerCase()]=a}),Wd={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},Xd=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight","rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(","),Xd.replace(l,function(a){Wd[a.toLowerCase()]=a}),Yd=avalon.directive("attr",{init:function(a){var b,c;a.expr=Yc(a.expr.trim()),"include"===a.type&&(b=a.element,re(b,a),a.includeRendered=id(b,"data-include-rendered",a.vmodels),a.includeLoaded=id(b,"data-include-loaded",a.vmodels),c=a.includeReplace=!!avalon(b).data("includeReplace"),avalon(b).data("includeCache")&&(a.templateCache={}),a.start=e.createComment("ms-include"),a.end=e.createComment("ms-include-end"),c?(a.element=a.end,a._element=b,b.parentNode.insertBefore(a.start,b),b.parentNode.insertBefore(a.end,b.nextSibling)):(b.insertBefore(a.start,b.firstChild),b.appendChild(a.end)))},update:function(a){var f,g,h,i,j,c=this.element,d=this.param;if("href"===d||"src"===d)"string"!=typeof a||v.hasAttribute||(a=a.replace(/&amp;/g,"&")),c[d]=a,b.chrome&&"EMBED"===c.tagName&&(f=c.parentNode,g=document.createComment("ms-src"),f.replaceChild(g,c),f.replaceChild(c,g));else{if(h=a===!1||null===a||void 0===a,!u&&Wd[d]&&(d=Wd[d]),i=Vd[d],"boolean"==typeof c[i]&&(c[i]=!!a,a||(h=!0)),h)return c.removeAttribute(d);j=n.test(c)?!1:e.namespaces&&kc(c)?!0:d in c.cloneNode(!1),j?c[d]=a+"":c.setAttribute(d,a)}}}),"title,alt,src,value,css,include,href".replace(l,function(a){M[a]=Yd}),avalon.directive("class",{init:function(a){var d,e,f,g,h,j,k,b=a.param,c=a.type;!b||isFinite(b)?(a.param="",M.effect.init(a)):(i("ms-"+c+'-xxx="yyy"这种用法已经过时,请使用ms-'+c+'="xxx:yyy"'),a.expr="["+ed(b)+","+a.expr+"]",a.oldStyle=b),("hover"===c||"active"===c)&&(a.hasBindEvent||(d=a.element,e=avalon(d),f="mouseenter",g="mouseleave","active"===c&&(d.tabIndex=d.tabIndex||-1,f="mousedown",g="mouseup",h=e.bind("mouseleave",function(){a.toggleClass&&e.removeClass(a.newClass)}))),j=e.bind(f,function(){a.toggleClass&&e.addClass(a.newClass)}),k=e.bind(g,function(){a.toggleClass&&e.removeClass(a.newClass)}),a.rollback=function(){e.unbind("mouseleave",h),e.unbind(f,j),e.unbind(g,k)},a.hasBindEvent=!0)},update:function(a){var b=this,c=avalon(this.element);b.newClass=a[0],b.toggleClass=!!a[1],b.oldClass&&b.newClass!==b.oldClass&&c.removeClass(b.oldClass),b.oldClass=b.newClass,"class"===b.type&&(b.oldStyle?c.toggleClass(b.oldStyle,!!a[1]):c.toggleClass(b.newClass,b.toggleClass))}}),"hover,active".replace(l,function(a){M[a]=M["class"]}),avalon.directive("css",{init:M.attr.init,update:function(a){avalon(this.element).css(this.param,a)}}),avalon.directive("data",{priority:100,update:function(a){var b=this.element,c="data-"+this.param;a&&"object"==typeof a?b[c]=a:b.setAttribute(c,String(a))}}),Zd=/^(?:checkbox|radio)$/,$d=/^(?:radio|checked)$/,_d=/^(file|button|reset|submit|checkbox|radio|range)$/,avalon.directive("duplex",{priority:2e3,init:function(a,b){function h(b){a.changed.call(this,b,a)}function j(){g=!0}function k(){g=!1}var e,f,g,l,n,c=a.element,d=a.vmodels;switch(a.changed=id(c,"data-duplex-changed",d)||A,e=[],f=B("string,number,boolean,checked"),"radio"===c.type&&""===a.param&&(a.param="checked"),a.param.replace(m,function(d){Zd.test(c.type)&&$d.test(d)&&("radio"===d&&i("ms-duplex-radio已经更名为ms-duplex-checked"),d="checked",a.isChecked=!0,a.xtype="radio"),"bool"===d?(d="boolean",i("ms-duplex-bool已经更名为ms-duplex-boolean")):"text"===d&&(d="string",i("ms-duplex-text已经更名为ms-duplex-string")),f[d]&&(b=!0),avalon.Array.ensure(e,d)}),b||e.push("string"),a.param=e.join("-"),a.xtype||(a.xtype="SELECT"===c.tagName?"select":"checkbox"===c.type?"checkbox":"radio"===c.type?"radio":/^change/.test(c.getAttribute("data-duplex-event"))?"change":"input"),a.bound=function(b,d){c.addEventListener?c.addEventListener(b,d,!1):c.attachEvent("on"+b,d);var e=a.rollback;a.rollback=function(){c.avalonSetter=null,avalon.unbind(c,b,d),e&&e()}},g=!1,l=function(){var e,d=c.value;if(!g&&d!==a.oldValue&&null!==a.pipe){e=a.pipe(d,a,"get");try{a.setter(e),h.call(c,e)}catch(f){i(f)}}},a.xtype){case"radio":a.bound("click",function(){var b=a.pipe(c.value,a,"get");try{a.setter(b),h.call(c,b)}catch(d){i(d)}});break;case"checkbox":a.bound(u?"change":"click",function(){var e,b=c.checked?"ensure":"remove",d=a.getter.apply(0,a.vmodels);Array.isArray(d)||(i("ms-duplex应用于checkbox上要对应一个数组"),d=[d]),e=a.pipe(c.value,a,"get"),avalon.Array[b](d,e),h.call(c,d)});break;case"change":a.bound("change",l);break;case"input":E?(E>8?a.bound("input",l):a.bound("propertychange",function(a){"value"===a.propertyName&&l()}),a.bound("dragend",function(){setTimeout(function(){l()},17)})):(a.bound("input",l),a.bound("compositionstart",j),a.bound("compositionend",k),a.bound("DOMAutoComplete",l));break;case"select":a.bound("change",function(){var b=avalon(c).val();if(b=Array.isArray(b)?b.map(function(b){return a.pipe(b,a,"get")}):a.pipe(b,a,"get"),b+""!==a.oldValue)try{a.setter(b)}catch(d){i(d)}}),a.bound("datasetchanged",function(b){var d,e;"selectDuplex"===b.bubble&&(d=a._value,e=Array.isArray(d)?d.map(String):d+"",avalon(c).val(e),c.oldValue=e+"",h.call(c,e))})}"input"!==a.xtype||_d.test(c.type)||("hidden"!==c.type&&(a.bound("focus",function(){c.msFocus=!0,n=c.value}),a.bound("blur",function(){c.msFocus=!1,E&&n!==c.value&&(n=c.value,avalon.fireDom(c,"change"))})),c.avalonSetter=l,ge(function(){if(c.contains(c))this.msFocus||a.oldValue===c.value||l();else if(!c.msRetain)return!1}))},update:function(a){var d,e,f,g,h,i,k,b=this.element,c=this;if(!this.init){for(e in avalon.vmodels)f=avalon.vmodels[e],f.$fire("avalon-ms-duplex-init",c);g=c.pipe||(c.pipe=ce),g(null,c,"init"),this.init=1}switch(this.xtype){case"input":case"change":if(d=this.pipe(a,this,"set"),d!==this.oldValue){if(h=!1,b.msFocus)try{i=he(b),i.start===i.end&&(i=i.start,h=!0)}catch(j){}b.value=this.oldValue=d,h&&ie(b,i,i)}break;case"radio":d=c.isChecked?!!a:a+""===b.value,6===E?setTimeout(function(){b.defaultChecked=d,b.checked=d},31):b.checked=d;break;case"checkbox":k=[].concat(a),d=this.pipe(b.value,this,"get"),b.checked=k.indexOf(d)>-1;break;case"select":c._value=a,b.msHasEvent?avalon.fireDom(b,"datasetchanged",{bubble:b.msHasEvent}):b.msHasEvent="selectDuplex"}}}),E&&avalon.bind(e,"selectionchange",function(){var b=e.activeElement||{};"function"!=typeof b.avalonSetter||b.msFocus||b.avalonSetter()}),avalon.duplexHooks={checked:{get:function(a,b){return!b.oldValue}},string:{get:function(a){return a},set:be},"boolean":{get:function(a){return"true"===a},set:be},number:{get:function(a,b){var d,c=parseFloat(a+"");if(-a===-c)return c;switch(d=/strong|medium|weak/.exec(b.element.getAttribute("data-duplex-number"))||["medium"],d[0]){case"strong":return 0;case"medium":return""===a?"":0;case"weak":return a}},set:be}},ee=[],avalon.tick=function(a){1===ee.push(a)&&(de=setInterval(fe,60))},ge=A,new function(){function d(b){a[this.tagName].call(this,b),!this.msFocus&&this.avalonSetter&&this.oldValue!==b&&this.avalonSetter()}var a,b,c,e;try{a={},b=HTMLInputElement.prototype,c=HTMLTextAreaElement.prototype,e=HTMLInputElement.prototype,Object.getOwnPropertyNames(e),a["INPUT"]=Object.getOwnPropertyDescriptor(b,"value").set,Object.defineProperty(b,"value",{set:d}),a["TEXTAREA"]=Object.getOwnPropertyDescriptor(c,"value").set,Object.defineProperty(c,"value",{set:d})}catch(f){ge=avalon.tick}},avalon.directive("effect",{priority:5,init:function(a){var c,d,b=a.expr,e=b.replace(hb,function(a){return a.replace(/./g,"0")}).indexOf(":");-1===e?(c=b,d=!0):(c=b.slice(0,e),d=b.slice(e+1)),c=gb.test(b)?Yc(c):ed(c),a.expr="["+c+","+d+"]"},update:function(a){var e,f,g,h,c=a[0],d=this.element;d.getAttribute("data-effect-name")!==c&&(d.removeAttribute("data-effect-driver"),e=d.style,f=b.getComputedStyle?b.getComputedStyle(d):null,g=!1,f&&(je||ke)&&(h=e[ne]||f[ne],h&&"0s"!==h&&(d.setAttribute("data-effect-driver","t"),g=!0),g||(h=e[oe]||f[oe],h&&"0s"!==h&&(d.setAttribute("data-effect-driver","a"),g=!0))),g||avalon.effects[c]&&(d.setAttribute("data-effect-driver","j"),g=!0),g&&d.setAttribute("data-effect-name",c))}}),avalon.effects={},avalon.effect=function(a,b){avalon.effects[a]=b},je=!1,ke=!1,ne=avalon.cssName("transition-duration"),oe=avalon.cssName("animation-duration"),new function(){var c,d,g,a={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"};for(d in a){if(b[d]){c=a[d];break}try{document.createEvent(d),c=a[d];break}catch(f){}}"string"==typeof c&&(je=!0,le=c),a={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};for(d in a)if(b[d]){g=a[d];break}"string"==typeof g&&(je=!0,me=g)},pe=[],te=new Nd,ue.prototype={contrustor:ue,enterClass:function(){return ve(this,"enter")},leaveClass:function(){return ve(this,"leave")},actionFun:function(a,b,c){var d,e,f,g,h;document.hidden||(d=this,e=d.el,f="leave"===a,a=f?"leave":"enter",g=f?"enter":"leave",we(d,"abort"+se(g)),we(d,"before"+se(a)),f||b(e),h=function(g){e.removeEventListener(d.cssEvent,d.cssCallback),f?(b(e),avalon(e).removeClass(d.cssClass)):"a"===d.driver&&avalon(e).removeClass(d.cssClass),g!==!0&&(we(d,"after"+se(a)),c&&c(e)),d.dispose()},d.useCss?(d.cssCallback&&d.cssCallback(!0),d.cssClass=ve(d,a),d.cssCallback=h,d.update=function(){e.addEventListener(d.cssEvent,d.cssCallback),f||"t"!==d.driver||avalon(e).removeClass(d.cssClass)},avalon(e).addClass(d.cssClass),te.render(!0),te.queue.push(d)):we(d,a,h))},enter:function(){this.actionFun.apply(this,["enter"].concat(avalon.slice(arguments)))},leave:function(){this.actionFun.apply(this,["leave"].concat(avalon.slice(arguments)))},dispose:function(){this.update=this.cssCallback=null,pe.unshift(this)>100&&pe.pop()}},xe=function(a,b){var d,e,f,g,h,c=t.call(arguments,0);return"function"!=typeof c[2]&&c.splice(2,0,A),"function"!=typeof c[3]&&c.splice(3,0,A),d=c[2],e=c[3],f=c[4],(g=qe(a,f))?(h=b?"enter":"leave",g[h](d,e),void 0):(d(),e(),!1)},avalon.mix(avalon.effect,{apply:xe,append:function(a,b,c,d){return xe(a,1,function(){b.appendChild(a)},c,d)},before:function(a,b,c,d){return xe(a,1,function(){b.parentNode.insertBefore(a,b)},c,d)},remove:function(a,b,c,d){return xe(a,0,function(){a.parentNode===b&&b.removeChild(a)},c,d)}}),avalon.directive("html",{update:function(a){var g,h,i,j,k,b=this,c=this.element,d=1!==c.nodeType,f=d?c.parentNode:c;if(f){if(a=null==a?"":a,3===c.nodeType&&(g=C("html"),f.insertBefore(e.createComment(g),c),b.element=e.createComment(g+":end"),f.replaceChild(b.element,c),c=b.element),"object"!=typeof a)h=avalon.parseHTML(String(a));else if(11===a.nodeType)h=a;else if(1===a.nodeType||a.item)for(i=1===a.nodeType?a.childNodes:a.item,h=w.cloneNode(!0);i[0];)h.appendChild(i[0]);if(i=avalon.slice(h.childNodes),d){for(j=c.nodeValue.slice(0,-4);;){if(k=c.previousSibling,!k||8===k.nodeType&&k.nodeValue===j)break;f.removeChild(k)}f.insertBefore(h,c)}else avalon.clearHTML(c).appendChild(h);Dd(i,b.vmodels)}}}),avalon.directive("if",{priority:10,update:function(a){function j(){c.getAttribute(b.name)&&(c.removeAttribute(b.name),td(c,b.vmodels)),b.rollback=null}var f,k,l,m,n,b=this,c=this.element,d=b.stamp=+new Date,h=function(){d===b.stamp&&(b.recoverNode=null)};b.recoverNode&&b.recoverNode();try{if(!c.parentNode)return;f=c.parentNode}catch(i){return}if(a)8===c.nodeType&&(k=b.keep,l=avalon.effect.apply(k,1,function(){d===b.stamp&&(c.parentNode.replaceChild(k,c),c=b.element=k,k.getAttribute("_required")&&(c.required=!0,c.removeAttribute("_required")),c.querySelectorAll&&avalon.each(c.querySelectorAll("[_required=true]"),function(a){a.required=!0,a.removeAttribute("_required")}),j())},h),l=l===!1),l||j();else if(1===c.nodeType){c.required===!0&&(c.required=!1,c.setAttribute("_required","true"));try{avalon.each(c.querySelectorAll(":required"),function(a){c.required=!1,a.setAttribute("_required","true")})}catch(i){}m=b.element=e.createComment("ms-if"),n=c.nextSibling,b.recoverNode=function(){b.recoverNode=null,m.parentNode!==f&&(f.insertBefore(m,n),b.keep=c)},avalon.effect.apply(c,0,function(){b.recoverNode=null,d===b.stamp&&(c.parentNode.replaceChild(m,c),b.keep=c,g.appendChild(c),b.rollback=function(){c.parentNode===g&&g.removeChild(c)})},h)}}}),ye=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/gim,ze=/<noscript.*?>([\s\S]+?)<\/noscript>/im,Ae=function(){return new(b.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},Be=avalon.templateCache={},avalon.directive("include",{init:M.attr.init,update:function(a){var o,p,q,r,s,t,u,v,b=this,c=this.element,d=b.vmodels,f=b.includeRendered,h=b.effectName&&b.effectClass,j=b.templateCache,k=b.includeReplace,l=b.includeLoaded,m=k?c.parentNode:c,n=b._element;if(b.recoverNodes=b.recoverNodes||avalon.noop,o=function(i){var p,q,r,s,t,u,v,w,x,y,o=b._stamp=+new Date;for(l&&(p=l.apply(m,[i].concat(d)),"string"==typeof p&&(i=p)),f&&gd(m,function(){f.call(m)},0/0),q=b.includeLastID||"_default",b.includeLastID=a,r=j&&j[q]||e.createElement(c.tagName||b._element.tagName),h&&(r.className=h,m.insertBefore(r,b.start)),(j||{})[q]=r,s=b.recoverNodes(),s&&m.insertBefore(s,b.end);;){if(t=b.start.nextSibling,!t||t===r||t===b.end)break;r.appendChild(t)}avalon.effect.remove(r,m,function(){j&&o===b._stamp&&g.appendChild(r)},b),u=m,v=avalon.noop,w=avalon.noop,x=Ce(b,a,i),y=avalon.slice(x.childNodes),k&&h?(u=n,u.innerHTML="",u.setAttribute("ms-skip","true"),m.insertBefore(u,b.end.nextSibling),v=function(){u.insertBefore(x,null)},w=function(){b.recoverNodes=avalon.noop,o===b._stamp&&(x=De(y),m.insertBefore(x,b.end),Dd(y,d)),u.parentNode===m&&m.removeChild(u)
},b.recoverNodes=function(){return b.recoverNodes=avalon.noop,De(y)}):v=function(){m.insertBefore(x,b.end),Dd(y,d)},avalon.effect.apply(u,"enter",v,w)},"src"===b.param)"string"==typeof Be[a]?avalon.nextTick(function(){o(Be[a])}):Array.isArray(Be[a])?Be[a].push(o):(p=Ae(),p.onreadystatechange=function(){var b,c,e,d;if(4===p.readyState)if(b=p.status,b>=200&&300>b||304===b||1223===b){for(c=p.responseText,d=0;e=Be[a][d++];)e(c);Be[a]=c}else i("ms-include load ["+a+"] error")},Be[a]=[o],p.open("GET",a,!0),"withCredentials"in p&&(p.withCredentials=!0),p.setRequestHeader("X-Requested-With","XMLHttpRequest"),p.send(null));else if(q=a&&1===a.nodeType?a:e.getElementById(a)){if("NOSCRIPT"===q.tagName&&!q.innerHTML&&!q.fixIE78)for(p=Ae(),p.open("GET",location,!1),p.send(null),r=e.getElementsByTagName("noscript"),s=(p.responseText||"").match(ye)||[],t=s.length,u=0;t>u;u++)v=r[u],v&&(v.style.display="none",v.fixIE78=(s[u].match(ze)||["","&nbsp;"])[1]);avalon.nextTick(function(){o(q.fixIE78||q.value||q.innerText||q.innerHTML)})}}}),Ee=/\(([^)]*)\)/,Fe=avalon.directive("on",{priority:3e3,init:function(a){var c,d,b=a.expr;a.type="on",c=a.param.replace(/-\d+$/,""),"function"==typeof Fe[c+"Hook"]&&Fe[c+"Hook"](a),b.indexOf("(")>0&&b.indexOf(")")>-1&&(d=(b.match(Ee)||["",""])[1].trim(),(""===d||"$event"===d)&&(b=b.replace(Ee,""))),a.expr=b},update:function(a){var d,e,b=this,c=this.element;a=function(a){var c=b.getter||A;return c.apply(this,b.args.concat(a))},d=b.param.replace(/-\d+$/,""),"scan"===d?a.call(c,{type:d}):"function"==typeof b.specialBind?b.specialBind(c,a):e=avalon.bind(c,d,a),b.rollback=function(){"function"==typeof b.specialUnbind?b.specialUnbind():avalon.unbind(c,d,e)}}}),avalon.directive("repeat",{priority:90,init:function(a){var c,d,f,g,h,i,j,b=a.type;if(a.cache={},a.enterCount=0,c=a.element,1===c.nodeType){if(c.removeAttribute(a.name),re(c,a),a.param=a.param||"el",a.sortedCallback=id(c,"data-with-sorted",a.vmodels),d=id(c,"data-"+b+"-rendered",a.vmodels),f=C(b),g=e.createComment(f+":start"),h=a.element=e.createComment(f+":end"),a.signature=f,a.start=g,a.template=w.cloneNode(!1),"repeat"===b)i=c.parentNode,i.replaceChild(h,c),i.insertBefore(g,h),a.template.appendChild(c);else{for(;c.firstChild;)a.template.appendChild(c.firstChild);c.appendChild(g),c.appendChild(h),i=c}a.element=h,d&&(j=avalon.bind(i,"datasetchanged",function(){d.apply(i,i.args),avalon.unbind(i,"datasetchanged",j),i.msRendered=d}))}},update:function(a,b){var e,f,g,i,h,j,k,l,m,n,o,p,q,r,s,t,u,v,x,y,z,A,B,C,c=this,d=this.xtype;if(this.enterCount+=1,e=!b)for(c.$outer={},f="$key",g="$val","array"===d&&(f="$first",g="$last"),h=0;i=c.vmodels[h++];)if(i.hasOwnProperty(f)&&i.hasOwnProperty(g)){c.$outer=i;break}for(j=this.track,c.sortedCallback&&(k=c.sortedCallback.call(t,j),k&&Array.isArray(k)&&(j=k)),l="move",c.$repeat=a,m=[],n=e&&w.cloneNode(!1),o=[],p=this.param,q=avalon.mix({},this.cache),r=this.element,s=j.length,t=r.parentNode,h=0;s>h;h++)u=j[h],v=q[u],v?(m.push({}),q[u]=!0):(v=Ke(this),v.$up=null,"array"===d?(l="add",v.$id=u,x=a[h],v[p]=x,Object(x)===x&&(x.$ups=x.$ups||{},x.$ups[p]=v)):(l="append",v.$key=u,v.$val=a[u]),this.cache[u]=v,y=v.$anchor||(v.$anchor=r.cloneNode(!1)),y.nodeValue=this.signature,Je(c,n,v,m,e&&!c.effectDriver),Oe(v,c,d)),1===this.enterCount&&(v.$active=!1,v.$oldIndex=v.$index,v.$active=!0,v.$index=h),"array"===d?(v.$first=0===h,v.$last=h===s-1):v.$val=Fb(a[u]),o.push(v);if(this.proxies=o,e&&!c.effectDriver)t.insertBefore(n,r),m.forEach(function(a){Dd(a.nodes||[],a.vmodels),a.nodes=a.vmodels=null});else{z=c.staggerIndex=0;for(u in q)q[u]!==!0&&(l="del",Ie(q[u].$anchor,c),Se(this.cache,u,p),q[u]=null);for(h=0;s>h;h++)v=o[h],u="array"===d?v.$id:v.$key,A=o[h-1],B=A?A.$anchor:c.start,q[u]?v.$index!==v.$oldIndex&&function(a,b){z=He(c.effectEnterStagger,function(){var d=Ie(a.$anchor),e=avalon.slice(d.childNodes);t.insertBefore(d,b.nextSibling),Ge(e,1,c)},z)}(v,B):function(a,b){var d=a.nodes,e=a.vmodels;d&&(z=He(c.effectEnterStagger,function(){t.insertBefore(a.content,b.nextSibling),Dd(d,e),Ge(d,1,c)},z)),a.nodes=a.vmodels=null}(m[h],B)}if(!a.$track)for(u in this.cache)Se(this.cache,u,p);!function(a){t.args=a,t.msRendered&&t.msRendered.apply(t,a)}(db.newWatch?arguments:[l]),C=setTimeout(function(){clearTimeout(C),avalon.fireDom(t,"datasetchanged",{bubble:t.msHasEvent})}),this.enterCount-=1}}),"with,each".replace(l,function(a){M[a]=avalon.mix({},M.repeat,{priority:1400})}),Le=[],Pe=[],avalon.directive("text",{update:function(a){var b=this.element;if(a=null==a?"":a,3===b.nodeType)try{b.data=a}catch(c){}else"textContent"in b?b.textContent=a:b.innerText=a}}),avalon.parseDisplay=Te,avalon.directive("visible",{init:function(a){re(a.element,a)},update:function(a){var d,b=this,c=this.element,e=!this.effectName;return this.stamp?(d=this.stamp=+new Date,a?avalon.effect.apply(c,1,function(){if(d===b.stamp){var a=c.getAttribute("data-effect-driver")||"a";e&&(c.style.display=b.display||""),("a"===a||"t"===a)&&"none"===avalon(c).css("display")&&(c.style.display=b.display||Te(c.nodeName))}}):avalon.effect.apply(c,0,function(){d===b.stamp&&(c.style.display="none")}),void 0):(d=this.stamp=+new Date,a?(c.style.display=b.display||"","none"===avalon(c).css("display")&&(c.style.display=b.display=Te(c.nodeName))):c.style.display="none",void 0)}}),Ue=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,Ve=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,We=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,Xe={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi},Ye=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ze=/([^\#-~| |!])/g,_e=avalon.filters={uppercase:function(a){return a.toUpperCase()},lowercase:function(a){return a.toLowerCase()},truncate:function(a,b,c){return b=b||30,c="string"==typeof c?c:"...",a.length>b?a.slice(0,b-c.length)+c:String(a)},$filter:function(a){var b,c,d,e,f;for(b=1,c=arguments.length;c>b;b++)d=arguments[b],e=avalon.filters[d[0]],"function"==typeof e&&(f=[a].concat(d.slice(1)),a=e.apply(null,f));return a},camelize:nc,sanitize:function(a){return a.replace(Ue,"").replace(We,function(a){var d,c=a.toLowerCase().match(/<(\w+)\s/);return c&&(d=Xe[c[1]],d&&(a=a.replace(d,function(a,b,c){var d=c.charAt(0);return b+"="+d+"javascript:void(0)"+d}))),a.replace(Ve," ").replace(/\s+/g," ")})},escape:function(a){return String(a).replace(/&/g,"&amp;").replace(Ye,function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1);return"&#"+(1024*(b-55296)+(c-56320)+65536)+";"}).replace(Ze,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(a,b,c){return(b||"￥")+$e(a,isFinite(c)?c:2)},number:$e},new function(){function a(a){return parseInt(a,10)||0}function b(a,b,c){var d="";for(0>a&&(d="-",a=-a),a=""+a;a.length<b;)a="0"+a;return c&&(a=a.substr(a.length-b)),d+a}function c(a,c,d,e){return function(f){var g=f["get"+a]();return(d>0||g>-d)&&(g+=d),0===g&&-12===d&&(g=12),b(g,c,e)}}function d(a,b){return function(c,d){var e=c["get"+a](),f=(b?"SHORT"+a:a).toUpperCase();return d[f][e]}}function e(a){var c=-1*a.getTimezoneOffset(),d=c>=0?"+":"";return d+=b(Math[c>0?"floor":"ceil"](c/60),2)+b(Math.abs(c%60),2)}function f(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]}var j,g={yyyy:c("FullYear",4),yy:c("FullYear",2,0,!0),y:c("FullYear",1),MMMM:d("Month"),MMM:d("Month",!0),MM:c("Month",2,1),M:c("Month",1,1),dd:c("Date",2),d:c("Date",1),HH:c("Hours",2),H:c("Hours",1),hh:c("Hours",2,-12),h:c("Hours",1,-12),mm:c("Minutes",2),m:c("Minutes",1),ss:c("Seconds",2),s:c("Seconds",1),sss:c("Milliseconds",3),EEEE:d("Day"),EEE:d("Day",!0),a:f,Z:e},h=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,i=/^\/Date\((\d+)\)\/$/;_e.date=function(b,c){var j,k,l,m,n,o,p,q,r,d=_e.date.locate,e="",f=[];if(c=c||"mediumDate",c=d[c]||c,"string"==typeof b&&(/^\d+$/.test(b)?b=a(b):i.test(b)?b=+RegExp.$1:(l=b.trim(),m=[0,0,0,0,0,0,0],n=new Date(0),l=l.replace(/^(\d+)\D(\d+)\D(\d+)/,function(b,c,d,e){var f=4===e.length?[e,c,d]:[c,d,e];return m[0]=a(f[0]),m[1]=a(f[1])-1,m[2]=a(f[2]),""}),o=n.setFullYear,p=n.setHours,l=l.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(b,c,d,e,f){return m[3]=a(c),m[4]=a(d),m[5]=a(e),f&&(m[6]=Math.round(1e3*parseFloat("0."+f))),""}),q=0,r=0,l=l.replace(/Z|([+-])(\d\d):?(\d\d)/,function(b,c,d,e){return o=n.setUTCFullYear,p=n.setUTCHours,c&&(q=a(c+d),r=a(c+e)),""}),m[3]-=q,m[4]-=r,o.apply(n,m.slice(0,3)),p.apply(n,m.slice(3)),b=n)),"number"==typeof b&&(b=new Date(b)),"date"===avalon.type(b)){for(;c;)k=h.exec(c),k?(f=f.concat(k.slice(1)),c=f.pop()):(f.push(c),c=null);return f.forEach(function(a){j=g[a],e+=j?j(b,d):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),e}},j={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"},j.SHORTMONTH=j.MONTH,_e.date.locate=j},af=avalon.modules={"domReady!":{exports:avalon,state:3},avalon:{exports:avalon,state:4}},af.exports=af.avalon,bf=b.require,cf=b.define,lb.loader=function(a){var c=df&&a;b.require=c?df:bf,b.define=c?df.define:cf},new function(){function k(a,b){var d,e,f,g,c="js";return a=a.replace(/^(\w+)\!/,function(a,b){return c=b,""}),"ready"===c&&(i("debug: ready!已经被废弃，请使用domReady!"),c="domReady"),d="",a=a.replace(h,function(a){return d=a,""}),e="."+c,f=/js|css/.test(e)?e:"",a=a.replace(/\.[a-z0-9]+$/g,function(a){return a===e?(f=a,""):a}),g=avalon.mix({query:d,ext:f,res:c,name:a,toUrl:G},b),g.toUrl(a),g}function l(a){var f,b=a.name,c=a.res,d=af[b],e=b&&a.urlNoQuery;return d&&d.state>=1?b:(d=af[e],d&&d.state>=3?(df(d.deps||[],d.factory,e),e):(b&&!d&&(d=af[e]={id:e,state:1},f=function(e){y[c]=e,e.load(b,a,function(a){arguments.length&&void 0!==a&&(d.exports=a),d.state=4,v()})},y[c]?f(y[c]):df([c],f)),b?e:c+"!"))}function t(a,b){for(var d,c=0;d=a[c++];)if(4!==af[d].state&&(d===b||t(af[d].deps,b)))return!0}function u(a,b,c){var d=z(a.src);return a.onload=a.onreadystatechange=a.onerror=null,b||c&&af[d]&&!af[d].state?(setTimeout(function(){f.removeChild(a),a=null}),i("debug: 加载 "+d+" 失败"+b+" "+!af[d].state),void 0):!0}function v(){var b,a,d,e,g,f;a:for(a=c.length;b=c[--a];)if(d=af[b],e=d.deps){for(f=0;g=e[f];f++)if(4!==Object(af[g]).state)continue a;4!==d.state&&(c.splice(a,1),F(d.id,d.deps,d.factory),v())}}function x(a,b,g){function m(){var e=d.pop();e&&e.require(b),g&&g(),u(h,!1,!k)&&(i("debug: 已成功加载 "+a),b&&c.push(b),v())}var h=e.createElement("script"),k="onload"in h,l=k?"onload":"onreadystatechange";h[l]=k?m:function(){w.test(h.readyState)&&m()},h.onerror=function(){u(h,!0)},h.className=j,h.src=a,f.insertBefore(h,f.firstChild),i("debug: 正准备加载 "+a)}function z(a){return(a||"").replace(h,"")}function B(a){return/^(?:[a-z]+:)?\/\//i.test(String(a))}function C(a,b){return"1"[0]?a[b]:a.getAttribute(b,4)}function D(){var c,e,h,g,i;try{a.b.c()}catch(d){c=d.stack,!c&&b.opera&&(c=(String(d).match(/of linked script \S+/g)||[]).join(" "))}if(c)return c=c.split(/[@ ]/g).pop(),c="("===c[0]?c.slice(1,-1):c.replace(/\s/,""),z(c.replace(/(:\d+)?:\d+$/i,""));for(e=f.getElementsByTagName("script"),g=e.length;h=e[--g];)if(h.className===j&&"interactive"===h.readyState)return i=C(h,"src"),h.className=z(i)}function F(a,c,d){var h,f,g,j,k,e=Object(af[a]);for(e.state=4,f=0,g=[];h=c[f++];)"exports"===h?(j=e.exports||(e.exports={}),g.push(j)):g.push(af[h].exports);try{k=d.apply(b,g)}catch(l){i("执行["+a+"]模块的factory抛错： ",l)}return void 0!==k&&(e.exports=k),E.test(a)&&delete af[a],delete e.factory,k}function G(a){var b,c,d,e,f,g;return 0===a.indexOf(this.res+"!")&&(a=a.slice(this.res.length+1)),b=a,c=0,d=this.baseUrl,e=this.parentUrl||d,L(a,db.paths,function(a,d){b=b.replace(d,a),c=1}),c||L(a,db.packages,function(a,c,d){b=b.replace(d.name,d.location)}),this.mapUrl&&L(this.mapUrl,db.map,function(a){L(b,a,function(a,c){b=b.replace(c,a),e=d})}),f=this.ext,f&&c&&b.slice(-f.length)===f&&(b=b.slice(0,-f.length)),B(b)||(e=this.built||/^\w/.test(b)?d:e,b=O(e,b)),g=b+f,b=g+this.query,g=b.replace(h,function(a){return this.query=a,""}),L(a,db.urlArgs,function(a){b+=(-1===b.indexOf("?")?"?":"&")+a}),this.url=b,this.urlNoQuery=g}function H(a,b,c){var d=K(a,b,c);return d.sort(M),d}function I(a){return new RegExp("^"+a+"(/|$)")}function J(a){return function(){var c;return a.init&&(c=a.init.apply(b,arguments)),c||a.exports&&P(a.exports)}}function K(a,b,c){var e,f,d=[];for(e in a)q.call(a,e)&&(f={name:e,val:a[e]},d.push(f),f.reg="*"===e&&b?/^/:I(e),c&&"*"!==e&&(f.reg=new RegExp("/"+e.replace(/^\//,"")+"(/|$)")));return d}function L(a,b,c){b=b||[];for(var e,d=0;e=b[d++];)if(e.reg.test(a))return c(e.val,e.name,e),!1}function M(a,b){var c=a.name,d=b.name;return"*"===d?-1:"*"===c?1:d.length-c.length}function O(a,b){if("/"!==a.charAt(a.length-1)&&(a+="/"),"./"===b.slice(0,2))return a+b.slice(2);if(".."===b.slice(0,2)){for(a+=b;N.test(a);)a=a.replace(N,"");return a}return"/"===b.slice(0,1)?a+b.slice(1):a+b}function P(a){if(!a)return a;var c=b;return a.split(".").forEach(function(a){c=c[a]}),c}var o,p,r,s,w,y,E,N,Q,R,S,T,c=[],d=[],g=/\.js$/i,h=/(\?[^#]*)$/,m=[],n=!1;df=avalon.require=function(a,b,d,e){var h,f,i,j,o,p,q,r;if(n)Array.isArray(a)||avalon.error("require方法的第一个参数应为数组 "+a),i=[],j={},o=d||"callback"+setTimeout("1"),e=e||{},e.baseUrl=db.baseUrl,p=!!e.built,d&&(e.parentUrl=d.substr(0,d.lastIndexOf("/")),e.mapUrl=d.replace(g,"")),p?(q=k(e.defineName,e),o=q.urlNoQuery):a.forEach(function(a){var b=k(a,e),c=l(b);c&&(j[c]||(i.push(c),j[c]="司徒正美"))}),r=af[o],r&&4===r.state||(af[o]={id:o,deps:p?a.concat():i,factory:b||A,state:3}),r||c.push(o),v();else if(m.push(avalon.slice(arguments)),arguments.length<=2)for(n=!0,f=m.splice(0,m.length);h=f.shift();)df.apply(null,h)},df.define=function(a,b,c){var e,f,g,h;"string"!=typeof a&&(c=b,b=a,a="anonymous"),Array.isArray(b)||(c=b,b=[]),e={built:!n,defineName:a},f=[b,c,e],c.require=function(a){if(f.splice(2,0,a),af[a]){af[a].state=3;var b=!1;try{b=t(af[a].deps,a)}catch(d){}b&&avalon.error(a+"模块与之前的模块存在循环依赖，请不要直接用script标签引入"+a+"模块")}delete c.require,df.apply(null,f)},g=e.built?"unknown":D(),g?(h=af[g],h&&(h.state=2),c.require(g)):d.push(c)},df.config=db,df.define.amd=af,o=db["orig.paths"]={},p=db["orig.map"]={},r=db["packages"]=[],s=db["orig.args"]={},avalon.mix(lb,{paths:function(a){avalon.mix(o,a),db.paths=H(o)},map:function(a){avalon.mix(p,a);var b=H(p,1,1);avalon.each(b,function(a,b){b.val=H(b.val)}),db.map=b},packages:function(a){var b,c,e,d,f,h;for(a=a.concat(r),b={},c=[],d=0;e=a[d++];)e="string"==typeof e?{name:e}:e,f=e.name,b[f]||(h=O(e.location||f,e.main||"main"),h=h.replace(g,""),c.push(e),b[f]=e.location=h,e.reg=I(f));db.packages=c.sort()},urlArgs:function(a){"string"==typeof a&&(a={"*":a}),avalon.mix(s,a),db.urlArgs=H(s,1)},baseUrl:function(a){var b,c;B(a)||(b=f.getElementsByTagName("base")[0],b&&f.removeChild(b),c=e.createElement("a"),c.href=a,a=C(c,"href"),b&&f.insertBefore(b,f.firstChild)),a.length>3&&(db.baseUrl=a)},shim:function(a){var b,c;for(b in a)c=a[b],Array.isArray(c)&&(c=a[b]={deps:c}),c.exportsFn||!c.exports&&!c.init||(c.exportsFn=J(c));db.shim=a}}),w=/complete|loaded/,y=df.plugins={domReady:{load:A},js:{load:function(a,b,c){var d=b.url,e=b.urlNoQuery,f=db.shim[a.replace(g,"")];f?df(f.deps||[],function(){var a=avalon.slice(arguments);x(d,e,function(){c(f.exportsFn?f.exportsFn.apply(0,a):void 0)})}):x(d,e)}},css:{load:function(a,b,c){var d=b.url,g=e.createElement("link");g.rel="stylesheet",g.href=d,f.insertBefore(g,f.firstChild),i("debug: 已成功加载 "+d),c()}},text:{load:function(a,b,c){var f,g,d=b.url,e=Ae();e.onreadystatechange=function(){if(4===e.readyState){var a=e.status;a>399&&600>a?avalon.error(d+" 对应资源不存在或没有开启 CORS"):(i("debug: 已成功加载 "+d),c(e.responseText))}},f="_="+(new Date-0),g=-1===d.indexOf("?")?d+"?"+f:d+"&"+f,e.open("GET",g,!0),"withCredentials"in e&&(e.withCredentials=!0),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.send(),i("debug: 正准备加载 "+d)}}},df.checkDeps=v,E=/^callback\d+$/,N=/\/\w+\/\.\./,Q=e.scripts[e.scripts.length-1],R=Q.getAttribute("data-main"),R?(lb.baseUrl(R),S=db.baseUrl,db.baseUrl=S.slice(0,S.lastIndexOf("/")+1),x(S.replace(g,"")+".js")):(T=z(C(Q,"src")),db.baseUrl=T.slice(0,T.lastIndexOf("/")+1))},ef=[],gf=function(a){ff=!0;var b=avalon.require;for(b&&b.checkDeps&&(af["domReady!"].state=4,b.checkDeps());a=ef.shift();)a(avalon)},"complete"===e.readyState)setTimeout(gf);else if(u)e.addEventListener("DOMContentLoaded",gf);else{e.attachEvent("onreadystatechange",function(){"complete"===e.readyState&&gf()});try{jf=null===b.frameElement}catch(vb){}v.doScroll&&jf&&b.external&&hf()}return avalon.bind(b,"load",gf),avalon.ready=function(a){ff?a(avalon):ef.push(a)},avalon.config({loader:!0}),avalon.ready(function(){avalon.scan(e.body)}),"function"==typeof define&&define.amd&&define("avalon",[],function(){return avalon}),kf=b.avalon,avalon.noConflict=function(a){return a&&b.avalon===avalon&&(b.avalon=kf),avalon},void 0===c&&(b.avalon=avalon),avalon});